
<!DOCTYPE html>
<html lang="en-UK">
<head>
<meta charset="UTF-8" />
<meta name="author" content="Calum Ross" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="Lecture notes for the module MAT1001 Differential Calculus." />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MAT1001 Differential Calculus: Lecture Notes — Numerical Methods</title>
<link rel="stylesheet" type="text/css" href="lwarp.css" />

<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
// \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
  subequations: "0",
  section: "",
  loader: {
    load: ['[tex]/tagformat', '[tex]/textmacros'],
  },
  startup: {
    ready() {
      // These would be replaced by import commands if you wanted to make
      // a proper extension.
      const Configuration = MathJax._.input.tex.Configuration.Configuration;
      const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
      const Macro = MathJax._.input.tex.Symbol.Macro;
      const TexError = MathJax._.input.tex.TexError.default;
      const ParseUtil = MathJax._.input.tex.ParseUtil.default;
      const expandable = MathJax._.util.Options.expandable;

        // Insert the replacement string into the TeX string, and check
        // that there haven't been too many maxro substitutions (prevents
        // infinite loops).
        const useArgument = (parser, text) => {
          parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
          parser.i = 0;
          if (++parser.macroCount > parser.configuration.options.maxMacros) {
            throw new TexError('MaxMacroSub1',
            'MathJax maximum macro substitution count exceeded; ' +
            'is there a recursive macro call?');
          }
        }

        // Create the command map for:
        //     \ifstar, \ifnextchar, \ifblank, \ifstrequal, \gsub, \seteqnumber
        new CommandMap('Lwarp-macros', {
          ifstar: 'IfstarFunction',
          ifnextchar: 'IfnextcharFunction',
          ifblank: 'IfblankFunction',
          ifstrequal: 'IfstrequalFunction',
          gsubstitute: 'GsubstituteFunction',
          seteqnumber: 'SeteqnumberFunction'
        }, {
          // This function implements an ifstar macro.
          IfstarFunction(parser, name) {
             const resultstar = parser.GetArgument(name);
             const resultnostar = parser.GetArgument(name);
             const star = parser.GetStar();                 // true if there is a *
             useArgument(parser, star ? resultstar : resultnostar);
          },

          // This function implements an ifnextchar macro.
          IfnextcharFunction(parser, name) {
            let whichchar = parser.GetArgument(name);
            if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
              // $ syntax highlighting
              whichchar = String.fromCodePoint(parseInt(whichchar));
            }
            const resultnextchar = parser.GetArgument(name);
            const resultnotnextchar = parser.GetArgument(name);
            const gotchar = (parser.GetNext() === whichchar);
            useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
          },

          // This function implements an ifblank macro.
          IfblankFunction(parser, name) {
            const blankarg = parser.GetArgument(name);
            const resultblank = parser.GetArgument(name);
            const resultnotblank = parser.GetArgument(name);
            const isblank = (blankarg.trim() == "");
            useArgument(parser, isblank ? resultblank : resultnotblank);
          },

          // This function implements an ifstrequal macro.
          IfstrequalFunction(parser, name) {
            const strequalfirst = parser.GetArgument(name);
            const strequalsecond = parser.GetArgument(name);
            const resultequal = parser.GetArgument(name);
            const resultnotequal = parser.GetArgument(name);
            const isequal = (strequalfirst == strequalsecond);
            useArgument(parser, isequal ? resultequal : resultnotequal);
          },

          // This function implements a gsub macro.
          GsubstituteFunction(parser, name) {
            const gsubfirst = parser.GetArgument(name);
            const gsubsecond = parser.GetArgument(name);
            const gsubthird = parser.GetArgument(name);
            let gsubresult=gsubfirst.replace(gsubsecond, gsubthird);
            useArgument(parser, gsubresult);
          },

          // This function modifies the equation numbers.
          SeteqnumberFunction(parser, name) {
              // Get the macro parameters
              const star = parser.GetStar();                  // true if there is a *
              const optBrackets = parser.GetBrackets(name);   // contents of optional brackets
              const newsubequations = parser.GetArgument(name); // the subequations argument
              const neweqsection = parser.GetArgument(name); // the eq section argument
              const neweqnumber = parser.GetArgument(name);   // the eq number argument
              MathJax.config.subequations=newsubequations ;   // a string with boolean meaning
              MathJax.config.section=neweqsection ;           // a string with numeric meaning
              parser.tags.counter = parser.tags.allCounter = neweqnumber ;
          }

        });

        // Create the Lwarp-macros package
        Configuration.create('Lwarp-macros', {
          handler: {macro: ['Lwarp-macros']}
        });

        MathJax.startup.defaultReady();

        // For forward references:
        MathJax.startup.input[0].preFilters.add(({math}) => {
          if (math.inputData.recompile){
              MathJax.config.subequations = math.inputData.recompile.subequations;
              MathJax.config.section = math.inputData.recompile.section;
          }
        });
        MathJax.startup.input[0].postFilters.add(({math}) => {
          if (math.inputData.recompile){
              math.inputData.recompile.subequations = MathJax.config.subequations;
              math.inputData.recompile.section = MathJax.config.section;
          }
        });

          // For \left, \right with unicode-math:
          const {DelimiterMap} = MathJax._.input.tex.SymbolMap;
          const {Symbol} = MathJax._.input.tex.Symbol;
          const {MapHandler} = MathJax._.input.tex.MapHandler;
          const delimiter = MapHandler.getMap('delimiter');
          delimiter.add('\\lBrack', new Symbol('\\lBrack', '\u27E6'));
          delimiter.add('\\rBrack', new Symbol('\\rBrack', '\u27E7'));
          delimiter.add('\\lAngle', new Symbol('\\lAngle', '\u27EA'));
          delimiter.add('\\rAngle', new Symbol('\\rAngle', '\u27EB'));
          delimiter.add('\\lbrbrak', new Symbol('\\lbrbrak', '\u2772'));
          delimiter.add('\\rbrbrak', new Symbol('\\rbrbrak', '\u2773'));
          delimiter.add('\\lbag', new Symbol('\\lbag', '\u27C5'));
          delimiter.add('\\rbag', new Symbol('\\rbag', '\u27C6'));
          delimiter.add('\\llparenthesis', new Symbol('\\llparenthesis', '\u2987'));
          delimiter.add('\\rrparenthesis', new Symbol('\\rrparenthesis', '\u2988'));
          delimiter.add('\\llangle', new Symbol('\\llangle', '\u2989'));
          delimiter.add('\\rrangle', new Symbol('\\rrangle', '\u298A'));
          delimiter.add('\\Lbrbrak', new Symbol('\\Lbrbrak', '\u27EC'));
          delimiter.add('\\Rbrbrak', new Symbol('\\Rbrbrak', '\u27ED'));
          delimiter.add('\\lBrace', new Symbol('\\lBrace', '\u2983'));
          delimiter.add('\\rBrace', new Symbol('\\rBrace', '\u2984'));
          delimiter.add('\\lParen', new Symbol('\\lParen', '\u2985'));
          delimiter.add('\\rParen', new Symbol('\\rParen', '\u2986'));
          delimiter.add('\\lbrackubar', new Symbol('\\lbrackubar', '\u298B'));
          delimiter.add('\\rbrackubar', new Symbol('\\rbrackubar', '\u298C'));
          delimiter.add('\\lbrackultick', new Symbol('\\lbrackultick', '\u298D'));
          delimiter.add('\\rbracklrtick', new Symbol('\\rbracklrtick', '\u298E'));
          delimiter.add('\\lbracklltick', new Symbol('\\lbracklltick', '\u298F'));
          delimiter.add('\\rbrackurtick', new Symbol('\\rbrackurtick', '\u2990'));
          delimiter.add('\\langledot', new Symbol('\\langledot', '\u2991'));
          delimiter.add('\\rangledot', new Symbol('\\rangledot', '\u2992'));
          delimiter.add('\\lparenless', new Symbol('\\lparenless', '\u2993'));
          delimiter.add('\\rparengtr', new Symbol('\\rparengtr', '\u2994'));
          delimiter.add('\\Lparengtr', new Symbol('\\Lparengtr', '\u2995'));
          delimiter.add('\\Rparenless', new Symbol('\\Rparenless', '\u2996'));
          delimiter.add('\\lblkbrbrak', new Symbol('\\lblkbrbrak', '\u2997'));
          delimiter.add('\\rblkbrbrak', new Symbol('\\rblkbrbrak', '\u2998'));
          delimiter.add('\\lvzigzag', new Symbol('\\lvzigzag', '\u29D8'));
          delimiter.add('\\rvzigzag', new Symbol('\\rvzigzag', '\u29D9'));
          delimiter.add('\\Lvzigzag', new Symbol('\\Lvzigzag', '\u29DA'));
          delimiter.add('\\Rvzigzag', new Symbol('\\Rvzigzag', '\u29DB'));
          delimiter.add('\\lcurvyangle', new Symbol('\\lcurvyangle', '\u29FC'));
          delimiter.add('\\rcurvyangle', new Symbol('\\rcurvyangle', '\u29FD'));
          delimiter.add('\\Vvert', new Symbol('\\Vvert', '\u2980'));
    }     // ready
  },      // startup

  tex: {
    packages: {'[+]': ['tagformat', 'Lwarp-macros', 'textmacros']},
    tags: "ams",
         tagformat: {
             number: function (n) {
                 if(MathJax.config.subequations==0)
                     return(MathJax.config.section + n);
                 else
                     return(MathJax.config.section + String.fromCharCode(96+n));
             },
         },
  }
}
</script>

<script
    id="MathJax-script"
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
></script>

</head>
<body>


<a id="mat1001-autopage-205"></a>
<nav class="topnavigation"><a href="index.html" class="linkhome" >
Home</a></nav>


<div class="bodyandsidetoc">
<div class="sidetoccontainer">


<nav class="sidetoc">


<div class="sidetoctitle">

<p>
<span class="sidetocthetitle">MAT1001 Differential Calculus: Lecture Notes</span>
</p>

<p>
Contents
</p>
</div>


<div class="sidetoccontents">

<p>
<a href="index.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="Why-Do-We-Need-Calculus.html#autosec-5" class="tocchapter" >
<span class="sectionnumber">1</span>&#x2003;Why Do We Need Calculus</a>
</p>


<p>
<a href="Why-Do-We-Need-Calculus.html#autosec-6" class="tocsection" >
<span class="sectionnumber">1.1</span>&#x2003;Course Overview</a>
</p>


<p>
<a href="Why-Do-We-Need-Calculus.html#autosec-7" class="tocsection" >
<span class="sectionnumber">1.2</span>&#x2003;Why Calculus</a>
</p>


<p>
<a href="Functions.html#autosec-15" class="tocchapter" >
<span class="sectionnumber">2</span>&#x2003;Functions</a>
</p>


<p>
<a href="Functions.html#autosec-16" class="tocsection" >
<span class="sectionnumber">2.1</span>&#x2003;What is a function</a>
</p>


<p>
<a href="Functions.html#autosec-30" class="tocsection" >
<span class="sectionnumber">2.2</span>&#x2003;Trigonometric functions</a>
</p>


<p>
<a href="Functions.html#autosec-44" class="tocsection" >
<span class="sectionnumber">2.3</span>&#x2003;Logarithms and Exponentials</a>
</p>


<p>
<a href="Functions.html#autosec-55" class="tocsection" >
<span class="sectionnumber">2.4</span>&#x2003;Hyperbolic functions</a>
</p>


<p>
<a href="Functions.html#autosec-60" class="tocsection" >
<span class="sectionnumber">2.5</span>&#x2003;Limits and asymptotics</a>
</p>


<p>
<a href="Functions.html#autosec-74" class="tocsection" >
<span class="sectionnumber">2.6</span>&#x2003;Continuity and differentiability</a>
</p>


<p>
<a href="Differentiation.html#autosec-91" class="tocchapter" >
<span class="sectionnumber">3</span>&#x2003;Differentiation</a>
</p>


<p>
<a href="Differentiation.html#autosec-92" class="tocsection" >
<span class="sectionnumber">3.1</span>&#x2003;Differentiation from first principles</a>
</p>


<p>
<a href="Differentiation.html#autosec-101" class="tocsection" >
<span class="sectionnumber">3.2</span>&#x2003;Differentiation techniques</a>
</p>


<p>
<a href="Differentiation.html#autosec-121" class="tocsection" >
<span class="sectionnumber">3.3</span>&#x2003;Multiple derivatives</a>
</p>


<p>
<a href="Differentiation.html#autosec-123" class="tocsection" >
<span class="sectionnumber">3.4</span>&#x2003;Applications of differentiation</a>
</p>


<p>
<a href="Integration.html#autosec-147" class="tocchapter" >
<span class="sectionnumber">4</span>&#x2003;Integration</a>
</p>


<p>
<a href="Integration.html#autosec-148" class="tocsection" >
<span class="sectionnumber">4.1</span>&#x2003;Integration and antiderivatives</a>
</p>


<p>
<a href="Integration.html#autosec-158" class="tocsection" >
<span class="sectionnumber">4.2</span>&#x2003;Techniques for integration</a>
</p>


<p>
<a href="Integration.html#autosec-167" class="tocsection" >
<span class="sectionnumber">4.3</span>&#x2003;Definite integrals</a>
</p>


<p>
<a href="Integration.html#autosec-192" class="tocsection" >
<span class="sectionnumber">4.4</span>&#x2003;Applications of integrals</a>
</p>


<p>
<a href="Differential-Equations.html#autosec-204" class="tocchapter" >
<span class="sectionnumber">5</span>&#x2003;Differential Equations</a>
</p>


<p>
<a href="Numerical-Methods.html#autosec-206" class="tocchapter" >
<span class="sectionnumber">6</span>&#x2003;Numerical Methods</a>
</p>


<p>
<a href="Numerical-Methods.html#autosec-207" class="tocsection" >
<span class="sectionnumber">6.1</span>&#x2003;Solving equations numerically</a>
</p>


<p>
<a href="Numerical-Methods.html#autosec-239" class="tocsection" >
<span class="sectionnumber">6.2</span>&#x2003;Approximating functions</a>
</p>


<p>
<a href="Numerical-Methods.html#autosec-265" class="tocsection" >
<span class="sectionnumber">6.3</span>&#x2003;Numerical integration</a>
</p>


<p>
<a href="Numerical-Methods.html#autosec-291" class="tocsection" >
<span class="sectionnumber">6.4</span>&#x2003;Numerical differentiation</a>
</p>


<p>
<a href="Numerical-Methods.html#autosec-312" class="tocsection" >
<span class="sectionnumber">6.5</span>&#x2003;Numerical approaches to differential equations</a>
</p>


<p>
<a href="Calculus-in-Computer-Science.html#autosec-314" class="tocchapter" >
<span class="sectionnumber">7</span>&#x2003;Calculus in Computer Science</a>
</p>


<p>
<a href="Calculus-in-Computer-Science.html#autosec-315" class="tocsection" >
<span class="sectionnumber">7.1</span>&#x2003;Computer Science</a>
</p>


<p>
<a href="Calculus-in-Computer-Science.html#autosec-316" class="tocsection" >
<span class="sectionnumber">7.2</span>&#x2003;Computer Science and AI</a>
</p>


<p>
<a href="Calculus-in-Computer-Science.html#autosec-318" class="tocsection" >
<span class="sectionnumber">7.3</span>&#x2003;Robotics and AI</a>
</p>


<p>
<a href="Advanced-Topics.html#autosec-320" class="tocchapter" >
<span class="sectionnumber">8</span>&#x2003;Advanced Topics</a>
</p>


<p>
<a href="Advanced-Topics.html#autosec-321" class="tocsection" >
<span class="sectionnumber">8.1</span>&#x2003;L’Ho&#x0302;pital’s rule for evaluating limits</a>
</p>


<p>
<a href="Advanced-Topics.html#autosec-325" class="tocsection" >
<span class="sectionnumber">8.2</span>&#x2003;Trigonometric Derivatives in Degrees</a>
</p>


<p>
<a href="Advanced-Topics.html#autosec-326" class="tocsection" >
<span class="sectionnumber">8.3</span>&#x2003;Functions of two variables</a>
</p>


<p>
<a href="Advanced-Topics.html#autosec-327" class="tocsection" >
<span class="sectionnumber">8.4</span>&#x2003;Multiple integrals</a>
</p>


<p>
<a href="Advanced-Topics.html#autosec-328" class="tocsection" >
<span class="sectionnumber">8.5</span>&#x2003;Optimisation Problems</a>
</p>


<p>
<a href="Advanced-Topics.html#autosec-329" class="tocsection" >
<span class="sectionnumber">8.6</span>&#x2003;Polynomial approximation</a>
</p>


<p>
<a href="Background-Mathematics.html#autosec-331" class="tocchapter" >
<span class="sectionnumber">9</span>&#x2003;Background Mathematics</a>
</p>


<p>
<a href="Background-Mathematics.html#autosec-332" class="tocsection" >
<span class="sectionnumber">9.1</span>&#x2003;Background and References</a>
</p>


<p>
<a href="Background-Mathematics.html#autosec-333" class="tocsection" >
<span class="sectionnumber">9.2</span>&#x2003;Polynomials and roots</a>
</p>


<p>
<a href="Background-Mathematics.html#autosec-335" class="tocsection" >
<span class="sectionnumber">9.3</span>&#x2003;Trigonometry Primer</a>
</p>


<p>
<a href="Background-Mathematics.html#autosec-339" class="tocsection" >
<span class="sectionnumber">9.4</span>&#x2003;Radians and Degrees</a>
</p>


<p>
<a href="Background-Mathematics.html#autosec-346" class="tocsection" >
<span class="sectionnumber">9.5</span>&#x2003;Rearranging Equations</a>
</p>


<p>
<a href="Background-Mathematics.html#autosec-351" class="tocsection" >
<span class="sectionnumber">9.6</span>&#x2003;More on Limits</a>
</p>


<p>
<a href="Further-Reading.html#autosec-353" class="tocchapter" >
<span class="sectionnumber">10</span>&#x2003;Further Reading</a>
</p>


<p>
<a href="Further-Reading.html#autosec-354" class="tocsection" >
<span class="sectionnumber">10.1</span>&#x2003;Why Calculus Extra Reading</a>
</p>


<p>
<a href="Further-Reading.html#autosec-355" class="tocsection" >
<span class="sectionnumber">10.2</span>&#x2003;Functions Extra Reading</a>
</p>


<p>
<a href="Further-Reading.html#autosec-356" class="tocsection" >
<span class="sectionnumber">10.3</span>&#x2003;Differentiation Extra Reading</a>
</p>


<p>
<a href="Further-Reading.html#autosec-357" class="tocsection" >
<span class="sectionnumber">10.4</span>&#x2003;Integration Extra Reading</a>
</p>


<p>
<a href="Further-Reading.html#autosec-358" class="tocsection" >
<span class="sectionnumber">10.5</span>&#x2003;Differential Equations Extra Reading</a>
</p>


<p>
<a href="Further-Reading.html#autosec-359" class="tocsection" >
<span class="sectionnumber">10.6</span>&#x2003;Numerical Methods Extra Reading</a>
</p>


<p>
<a href="Further-Reading.html#autosec-360" class="tocsection" >
<span class="sectionnumber">10.7</span>&#x2003;Advanced Topics Extra Reading</a>
</p>


<p>
<a href="Tutorial-Sheets.html#autosec-362" class="tocchapter" >
<span class="sectionnumber">11</span>&#x2003;Tutorial Sheets</a>
</p>


<p>
<a href="Tutorial-Sheets.html#autosec-363" class="tocsection" >
<span class="sectionnumber">11.1</span>&#x2003;Week 1</a>
</p>


<p>
<a href="Tutorial-Sheets.html#autosec-379" class="tocsection" >
<span class="sectionnumber">11.2</span>&#x2003;Week 2</a>
</p>


<p>
<a href="Tutorial-Sheets.html#autosec-403" class="tocsection" >
<span class="sectionnumber">11.3</span>&#x2003;Week 3</a>
</p>


<p>
<a href="Extra-Proofs-Derivations.html#autosec-409" class="tocchapter" >
<span class="sectionnumber">12</span>&#x2003;Extra Proofs and Derivations</a>
</p>


<p>
<a href="Standard-Derivatives-Integrals.html#autosec-412" class="tocchapter" >
<span class="sectionnumber">13</span>&#x2003;Standard Derivatives and Integrals</a>
</p>


<p>
<a href="Standard-Derivatives-Integrals.html#autosec-413" class="tocsection" >
<span class="sectionnumber">13.1</span>&#x2003;Derivatives</a>
</p>


<p>
<a href="Standard-Derivatives-Integrals.html#autosec-416" class="tocsection" >
<span class="sectionnumber">13.2</span>&#x2003;Integrals</a>
</p>


<p>
<a href="Bibliography.html#autosec-420" class="tocchapter" >
Bibliography</a>
</p>


</div>

</nav>

</div>


<main class="bodycontainer">


<section class="textbody">

<h1>MAT1001 Differential Calculus: Lecture Notes</h1>

<!--MathJax customizations:-->
<div data-nosnippet
    style="display:none"
>

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\let \LWRorighspace \hspace \)

\(\renewcommand {\hspace }{\ifstar \LWRorighspace \LWRorighspace }\)

\(\newcommand {\TextOrMath }[2]{#2}\)

\(\newcommand {\mathnormal }[1]{{#1}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\arabic }[1]{}\)

\(\newcommand {\number }[1]{}\)

\(\newcommand {\noalign }[1]{\text {#1}\notag \\}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\newcommand {\LWRabsorboption }[1][]{}\)

\(\newcommand {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\def \oe {\unicode {x0153}}\)

\(\def \OE {\unicode {x0152}}\)

\(\def \ae {\unicode {x00E6}}\)

\(\def \AE {\unicode {x00C6}}\)

\(\def \aa {\unicode {x00E5}}\)

\(\def \AA {\unicode {x00C5}}\)

\(\def \o {\unicode {x00F8}}\)

\(\def \O {\unicode {x00D8}}\)

\(\def \l {\unicode {x0142}}\)

\(\def \L {\unicode {x0141}}\)

\(\def \ss {\unicode {x00DF}}\)

\(\def \SS {\unicode {x1E9E}}\)

\(\def \dag {\unicode {x2020}}\)

\(\def \ddag {\unicode {x2021}}\)

\(\def \P {\unicode {x00B6}}\)

\(\def \copyright {\unicode {x00A9}}\)

\(\def \pounds {\unicode {x00A3}}\)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\( \newcommand {\multicolumn }[3]{#3}\)

\(\require {textcomp}\)

\(\require {upgreek}\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\let \Hat \hat \)

\(\let \Check \check \)

\(\let \Tilde \tilde \)

\(\let \Acute \acute \)

\(\let \Grave \grave \)

\(\let \Dot \dot \)

\(\let \Ddot \ddot \)

\(\let \Breve \breve \)

\(\let \Bar \bar \)

\(\let \Vec \vec \)

\(\require {cancel}\)

\(\newcommand {\LWRsubmultirow }[2][]{#2}\)

\(\newcommand {\LWRmultirow }[2][]{\LWRsubmultirow }\)

\(\newcommand {\multirow }[2][]{\LWRmultirow }\)

\(\newcommand {\mrowcell }{}\)

\(\newcommand {\mcolrowcell }{}\)

\(\newcommand {\STneed }[1]{}\)

\(\def \ud {\mathrm {d}}\)

\(\def \ui {\mathrm {i}}\)

\(\def \uj {\mathrm {j}}\)

\(\def \uh {\mathrm {h}}\)

\(\newcommand {\R }{\mathbb {R}}\)

\(\newcommand {\N }{\mathbb {N}}\)

\(\newcommand {\C }{\mathbb {C}}\)

\(\newcommand {\Z }{\mathbb {Z}}\)

\(\newcommand {\CP }{\mathbb {C}P}\)

\(\newcommand {\RP }{\mathbb {R}P}\)

\(\def \bk {\vec {k}}\)

\(\def \bm {\vec {m}}\)

\(\def \bn {\vec {n}}\)

\(\def \be {\vec {e}}\)

\(\def \bE {\vec {E}}\)

\(\def \bx {\vec {x}}\)

\(\def \uL {\mathrm {L}}\)

\(\def \uU {\mathrm {U}}\)

\(\def \uW {\mathrm {W}}\)

\(\def \uE {\mathrm {E}}\)

\(\def \uT {\mathrm {T}}\)

\(\def \uV {\mathrm {V}}\)

\(\def \uM {\mathrm {M}}\)

\(\def \uH {\mathrm {H}}\)

\(\DeclareMathOperator {\sech }{sech}\)

\(\DeclareMathOperator {\csch }{csch}\)

\(\DeclareMathOperator {\arcsec }{arcsec}\)

\(\DeclareMathOperator {\arccot }{arcCot}\)

\(\DeclareMathOperator {\arccsc }{arcCsc}\)

\(\DeclareMathOperator {\arccosh }{arcCosh}\)

\(\DeclareMathOperator {\arcsinh }{arcsinh}\)

\(\DeclareMathOperator {\arctanh }{arctanh}\)

\(\DeclareMathOperator {\arcsech }{arcsech}\)

\(\DeclareMathOperator {\arccsch }{arcCsch}\)

\(\DeclareMathOperator {\arccoth }{arcCoth}\)

\(\def \re {\textup {Re}}\)

\(\def \im {\textup {Im}}\)

\(\newcommand {\up }{\uppi }\)

\(\newcommand {\ut }{\uptheta }\)

\(\newcommand {\uw }{\upomega }\)

\(\newcommand {\uph }{\upphi }\)

\(\newcommand {\uvph }{\upvarphi }\)

</div>

<!--
...... chapter Numerical Methods ......
-->
<h3 id="autosec-206">Chapter&nbsp;<span class="sectionnumber">6&#x2003;</span>Numerical Methods</h3>
<a id="mat1001-autopage-206"></a>
<a id="mat1001-autofile-6"></a>

<a id="sec:numerics"></a>
<!--
...... section Solving equations numerically ......
-->
<h4 id="autosec-207"><span class="sectionnumber">6.1&#x2003;</span>Solving equations numerically</h4>
<a id="mat1001-autopage-207"></a>


<p>
It frequently happens that when confronted with a problem you end up with a mathematical problem or expression that cannot be evaluated analytically. This may be a differential equation that we cannot solve, an integral that has no closed form solution, or even an
algebraic equation which does not yield an explicit solution. This is where we have to turn to computer packages or follow a numerical method. Nowadays many computer programs can implement these approaches as standard. However, it is a good idea to understand
how to implement a few of these approaches by hand as you may end up writing one of your own at some stage.<br />

</p>

<p>
Chapter 27 of [Riley et&nbsp;al., 2006] contains a lot of information about this topic and is a good place to go for more details than we will discuss here.<br />

</p>

<p>
Before moving on to numerical differentiation and integration we will first discuss how to solve algebraic equations numerically. This is all about finding the real roots of an equation \(f(x)=0\). This equation can either be algebraic, with \(f(x)\) being a polynomial, or
transcendental, if \(f(x)\) includes trig, log, or exponential terms. We will be using iterative schemes to solve the equations, where we make successive approximations to the true solution, which converge to the true solution. For a method to be successful we need both
that the approximations converge to the true solution, and also that we only have a finite number of solutions.<br />

</p>

<p>
It is important to note that different iteration methods will be better at solving certain kinds of problems, in practice some combination of methods is likely to be used. We will see four methods, <b>Rearrangement</b>, <b>Linear interpolation</b>, and
<b>Bisection</b>, before discussing <b>Newton</b>’s method, which is the most important method to know in this module.
</p>
<!--
...... subsection Rearrangement ......
-->
<h5 id="autosec-208">Rearrangement</h5>
<a id="mat1001-autopage-208"></a>


<p>
To explain what we mean by an iterative scheme it is useful to consider the first example method, recasting our equation \(f(x)=0\) as
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{0}\)</span>

<!--


                                                                                                                                 x = ϕ(x),

-->

<p>

\begin{equation*}
x=\phi (x),
\end{equation*}

</p>

<p>
for some slowly varying function \(\phi (x)\). Our iteration scheme starts from a guess, \(x_{0}\) which will not solve \(f(x_{0})=0\) but should be picked so that it is close to zero<sup>1</sup>. We then have that \(x_{1}=\phi (x_{0})\) and can keep repeating this
process, i.e. \(x_{n+1}=\phi (x_{n})\). The solution we are looking for will be a value of \(x\) that is left unchanged by applying \(\phi \).<br />

</p>

<p>
The different methods are different ways of building \(\phi (x)\) so that we can start the iteration scheme.<br />

</p>

<p>
As an example of how to use the rearrangement iteration consider
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{0}\)</span>

<!--


                                                                               f (x) = x5 − 3x3 + 2x − 4 = 0.                                                                              (6.1)                     --><a id="eq:   equation for iterating"></a><!--

-->

<p>

\begin{equation}
f(x)=x^{5}-3x^3+2x-4=0.     \label {eq:   equation for iterating}
\end{equation}

</p>

<figure id="autoid-31" class="figure ">
<div class="center">

<p>
<span
    id="lateximage-mat1001-20"
    class="lateximagesource"
><!--
     y


 2                       f (x) = x5 − 3x3 + 2x − 4


 1

                              x
         0.5   1   1.5    2

−1

−2

−3

−4
--><img
    src="mat1001-images\image-20.svg"
    alt="(Graph of the function that we are studying via iteration.)"
    style=""
    class="lateximage"
></span>
</p>


<div class="figurecaption">
Figure&nbsp;6.1: A plot of the function \(f(x)=x^{5}-3x^3+2x-4\) for \(0\leq x\leq 1.86\).

</div>

<a id="fig:   interpolation polynomial"></a>

</div>

</figure>

<p>
By rearranging this equation we have that
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{1}\)</span>

<!--

                                                                                                                                                 15
                                                                                                                             x = 3x3 − 2x + 4          .

-->

<p>

\begin{equation*}
x=\left (3x^{3}-2x+4\right )^{\frac {1}{5}}.
\end{equation*}

</p>

<p>
From the plot we in fig.&nbsp;<a href="Numerical-Methods.html#fig:        interpolation polynomial">6.1</a> we see that the root is between \(x=1.5\) and \(x=2\) and to see how the method works we will not attempt to start from that close to the true root. Here we
take \(x_{0}=1.8\) and then iterate using
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{1}\)</span>

<!--

                                                                                                                                                        15
                                                                                                                          xn+1 = 3x3n − 2xn + 4               .

-->

<p>

\begin{equation*}
x_{n+1}=\left (3x_{n}^{3}-2x_{n}+4\right )^{\frac {1}{5}}.
\end{equation*}

</p>

<p>
The successive values of \(x_{n}\) and \(f(x_{n})\) are shown in table&nbsp;<a href="Numerical-Methods.html#table:1">6.1</a> and they are closing in on
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{1}\)</span>

<!--


                                                                                             x = 1.757632748,                                                                                               (6.2)                     --><a id="eq:     precise root"></a><!--

-->

<p>

\begin{equation}
x=1.757632748, \label {eq:      precise root}
\end{equation}

</p>

<p>
which is the value of the root to \(9\) decimal places. We see from the table that once we got to \(x_{5}\) we were only differing from the precise answer in the third decimal places, so are within two parts in \(10^{3}\). We can also see that lots of iterations are needed
to get an accurate answer. The precise number will depend on the specific problem.<br />

</p>

<figure id="autoid-32" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.1: Successive approximations to the root of eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:   equation for iterating">6.1</a>)</span> using the rearranged equation. As the convergence is relatively slow we jump several steps at
the end to show you it getting closer.

</div>

<a id="table:1"></a>
<table>

<tr style="display:none"><th>.</th></tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(n\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{n}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{n})\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.8\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.99968\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.7805378\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.52247969\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.7700175\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.27736234\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(3\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.7643295\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.14849136\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(4\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.761254\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.07986324\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(5\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.7595909\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.043059716\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(12\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.75765592\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.00058017842\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black">\(18\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.7576331\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(7.8434818\times 10^{-6}\)</td>
</tr>

<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>
<div role="note" class="footnotes">

<a id="mat1001-autopage-214"></a>

<p>
<sup>1</sup>&nbsp;It is useful to plot or roughly sketch the function \(f(x)\) as then it can be easier to pick a starting point.
</p>


</div>



<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker">
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.1</span></span>. </span> Implement this iteration method numerically for eq.&nbsp;<span class="textup">(<a
href="Numerical-Methods.html#eq:       equation for iterating">6.1</a>)</span> using a programming language or computer program of your choice. I would suggest trying Python or Matlab, but you can use whatever you feel most comfortable with.
</p>

</li>

</ul>

</div>
<!--
...... subsection Linear interpolation ......
-->
<h5 id="autosec-215">Linear interpolation</h5>
<a id="mat1001-autopage-215"></a>


<p>
The next method to look at is <b>linear interpolation</b>. The idea here is to pick two points \(A_{1},B_{1}\) on the graph \(y=f(x)\) that lie on either side of the root, i.e. so that \(f(A_{1})\) and \(f(B_{1})\) have opposite signs. We can then think about the
straight line<sup>2</sup> joining these points \((A_{1},f(A_{1}))\) to \((B_{1},f(B_{1}))\). An example of this is shown in fig.&nbsp;<a href="Numerical-Methods.html#fig: interpolation polynomial 2">6.2</a> where \(A_{1}=1.5\) and \(B_{1}=1.8\).<br />

</p>

<p>
The intersection of this straight line with the \(x\)-axis is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{2}\)</span>

<!--

                                                                                                                               A1 f (B1 ) − B1 f (A1 )
                                                                                                                        x1 =                           ,
                                                                                                                                  f (B1 ) − f (A1 )

-->

<p>

\begin{equation*}
x_{1}=\frac {A_{1}f(B_{1})-B_{1}f(A_{1})}{f(B_{1})-f(A_{1})},
\end{equation*}

</p>

<p>
We then replace \(A_{1}\) or \(B_{1}\) by \(x_{1}\), find the point on the curve corresponding to \(x=x_{1}\) and then iterate this process using the interpolation formula
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{2}\)</span>

<!--

                                                                                     An f (Bn ) − Bn f (An )
                                                                              xn =                           .                                                                      (6.3)                     --><a id="eq:   linear interpolation formula"></a><!--
                                                                                        f (Bn ) − f (An )

-->

<p>

\begin{equation}
x_{n}=\frac {A_{n}f(B_{n})-B_{n}f(A_{n})}{f(B_{n})-f(A_{n})}.            \label {eq:   linear interpolation formula}
\end{equation}

</p>

<figure id="autoid-33" class="figure ">
<div class="center">

<p>
<span
    id="lateximage-mat1001-21"
    class="lateximagesource"
><!--
     y


 2                             f (x) = x5 − 3x3 + 2x − 4


 1                        B1

                                    x
         0.5   1    1.5         2

−1

−2

−3
                   A1
−4
--><img
    src="mat1001-images\image-21.svg"
    alt="(Graph of the function that we are studying via iteration with the linear regression chord shown.)"
    style=""
    class="lateximage"
></span>
</p>


<div class="figurecaption">
Figure&nbsp;6.2: A plot of the function \(f(x)=x^{5}-3x^3+2x-4\) for \(0\leq x\leq 1.86\) with the first linear interpolation chords shown in red.

</div>

<a id="fig:   interpolation polynomial 2"></a>

</div>

</figure>

<p>
With each iteration the chord will become shorter and the end points will move until the value of \(x_{n}\) converges to the precise value of the root. The first few steps of this interpolation starting from \(A_{1}=1.5\) and \(B_{1}=1.8\) are shown in table&nbsp;<a
href="Numerical-Methods.html#table:2">6.2</a>.
</p>

<figure id="autoid-34" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.2: Successive approximations to the root of eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:   equation for iterating">6.1</a>)</span> using linear interpolation. This is converging very slowly and changes by around \(0.0003\)
each iteration.

</div>

<a id="table:2"></a>
<table>

<tr style="display:none"><th>.</th></tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:               1px solid black">\(n\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(A_{n}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(A_{n})\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(B_{n}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(B_{n})\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{n}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{n})\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:               1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.5\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(-3.5315\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.8\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.99968\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.50003\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(-3.5310\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:               1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.50003\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(-3.5310\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.8\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.99968\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.50006\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(-3.53082\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:               1px solid black">\(3\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:               1px solid black">\(4\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:               1px solid black">\(5\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<p>
We can see from this example that the linear interpolation method is much slower than rearrangement method, this will not always be true, but is your first hint that you should play around with several approaches before settling on the one that works the best. If you are
writing code for these problems, then it is a good idea to have code that can implement any of the iteration schemes that we are discussing here.
</p>
<div role="note" class="footnotes">

<a id="mat1001-autopage-221"></a>
<p>
<sup>2</sup>&nbsp;This straight line is known as a chord.
</p>


</div>
<!--
...... subsection Bisection method ......
-->
<h5 id="autosec-222">Bisection method</h5>
<a id="mat1001-autopage-222"></a>


<p>
Another method for finding roots is the Bisection method. Consider a root \(a\) of a function \(f(x)\). The idea here is to guess two points, one on either side of the root \(a\), and then keep shrinking the size of the interval until we have an estimate of the value of the
root. Since the function is zero at the root, we can check that we have actually picked points on either side of the root by checking that the function has different signs on either side of the interval.<br />

</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-223"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.2</span></span>. </span> Consider the function \(f(x)=x^{4}+2x-2\), we start by guessing that the root is contained in the interval \([1/2, 1]\). We can
check this by computing that \(f(1/2)=-0.9375\) while \(f(1)=1\). Since the function changes sign across the interval, we know that it has a zero in the interval. We call the left end of teh interval \(a_{0}\) and the right end \(b_{0}\), and for each step of refining the
interval we will have an \(a_{r}\) and a \(b_{r}\). To narrow down the position of the root we find the mid point of the interval and evaluate the function there:
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{3}\)</span>

<!--


                                                                                                                            a1 + b1   1/2 + 1  3
                                                                                                                     c1 =           =         = = 0.75.
                                                                                                                               2         2     4

-->

<p>


\begin{equation*}
c_{1}=\frac {a_{1}+b_{1}}{2}=\frac {1/2 +1}{2}=\frac {3}{4}=0.75.
\end{equation*}


</p>

<p>
and \(f(0.75)=-0.1836\). Since this is still negative we then know that the root lies in the interval \([0.75,1]\) and again we can find the new mid point:
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{3}\)</span>

<!--


                                                                                                                             a2 + b2   0.75 + 1
                                                                                                                      c2 =           =          = 0.875, .
                                                                                                                                2         2

-->

<p>


\begin{equation*}
c_{2}=\frac {a_{2}+b_{2}}{2}=\frac {0.75 +1}{2}=0.875,.
\end{equation*}


</p>

<p>
with \(f(0.875)=0.3362\). Since this is positive we can again restrict the interval to \([0.75,0.875]\). We can keep repeating this until we get the desired precision. Though it is much easier to do this in a table, as seen in table&nbsp;<a
href="Numerical-Methods.html#table:bisection">6.3</a>
</p>

<figure id="autoid-35" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.3: Successive approximations to the root of \(x^{4}+2x-2\) using the bisection method.

</div>

<a id="table:bisection"></a>
<table>

<tr style="display:none"><th>.</th></tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(r\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(a_{r}\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">sign of \(f(a_{r})\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(b_{r}\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">sign of \(f(b_{r})\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(c_{r}\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">sign of \(f(c_{r})\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.500000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(1.000000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.750000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.750000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(1.000000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.875000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(3\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.750000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.875000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.812500\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(4\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.750000\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.812500\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.781250\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(5\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.781250\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.812500\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.796875\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(6\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.796875\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.812500\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.804688\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(7\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.796875\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.804688\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.800781\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(8\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.796875\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(-\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.800781\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.798828\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(+\)</td>
</tr>


<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<p>
If we want an answer to two decimal places we find that the root is at \(x=0.80\). If we kept going we would find that to four decimal places the root is at \(x=0.7976\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-226"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.3</span></span>. </span> The function \(f(x)=x^{3}+3x-5\) has a root between \(1\) and \(2\), use the method of bisection four times to find the root.
</p>

</li>

</ul>

</div>
<!--
...... subsection Newton’s method ......
-->
<h5 id="autosec-227">Newton’s method</h5>
<a id="mat1001-autopage-227"></a>


<p>
The main numerical method that is needed in this module is <b>Newton’s method</b>, sometimes called the <b>Newton-Raphson</b> method. Newton’s method finds the root by constructing the tangent to a curve through the initial point \(x_{0}\), and then
taking the next point \(x_{1}\) to be where the tangent line intersects the \(x\)-axis.<br />

</p>

<figure id="autoid-36" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.4: Successive approximations to the root of eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:   equation for iterating">6.1</a>)</span> using Newton’s method. For this example, Newton’s method converges much quicker than
the other methods.

</div>

<a id="table:3"></a>
<table>

<tr style="display:none"><th>.</th></tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:                1px solid black">\(n\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{n}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{n})\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:                1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.8\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.99968\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:                1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.760530638\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.06382986248\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:                1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.757647406\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(0.00032122929\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black">\(3\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.757632748\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(8.267167839\times 10^{-9}\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black">\(4\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.757632748\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(-8.881784197\times 10^{-16}\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black">\(5\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.757632748\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(-8.881784197\times 10^{-16}\)</td>
</tr>

<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<p>
In other words we start from a guess, \(x_{0}\), then construct the tangent line
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{3}\)</span>

<!--


                                                                                                                        y(x) = (x − x0 ) f ′ (x0 ) + f (x0 ).

-->

<p>

\begin{equation*}
y(x)=\left (x-x_{0}\right )f&apos;(x_{0})+f(x_{0}).
\end{equation*}

</p>

<p>
Once we have the tangent we find the value of \(x\) such that \(y(x)=0\) and call this \(x_{1}\). Doing this for a general point in the iteration \(x_{n}\) the iteration scheme is
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{3}\)</span>

<!--

                                                                                                  f (xn )
                                                                                    xn+1 = xn −             .                                                                                (6.4)                      --><a id="eq:    Newton iteration scheme"></a><!--
                                                                                                  f ′ (xn )

-->

<p>

\begin{equation}
x_{n+1}=x_{n}-\frac {f(x_{n})}{f&apos;(x_{n})}.         \label {eq:   Newton iteration scheme}
\end{equation}

</p>

<p>
An important observation here is that if the points \(x_{n}\) get close to a critical point of \(f(x)\) then the scheme will break down as then \(f&apos;(x_{n})\) will be approaching zero. This means that we need to be very careful about picking our starting point, if we
pick one that is on the opposite side of a critical point from a root then we may not be able to get to the root. Figure&nbsp;<a href="Numerical-Methods.html#fig: Newton iteration">6.3</a> shows what the first step in Newton’s method looks like graphically.<br />

</p>

<figure id="autoid-37" class="figure ">
<div class="center">

<p>

<a href="figures/Newton_iteration.png" target="_blank" ><img
    src="figures/Newton_iteration.png"
    style="
    width:217pt;
    "
    class="inlineimage"
    alt="(A schematic of the first step of Newton’s method for finding roots)"
></a>
</p>


<div class="figurecaption">
Figure&nbsp;6.3: The first step of Newton’s iteration method to find the root of \(f(x)\). We pick a point \(x_{0}\) then find the tangent to \(f(x)\) at \(x_{0}\) and solve for the point \(x_{1}\) where this tangent intersects the \(x\)-axis. This is repeated until we
converge on the root.

</div>

<a id="fig:   Newton iteration"></a>

</div>

</figure>

<p>
For the specific equation in eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:        equation for iterating">6.1</a>)</span> we have that
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{4}\)</span>

<!--


                                                                                                                                   x5n − 3x3n + 2xn − 4
                                                                                                                     xn+1 = xn −                        .                                                                                                               (6.5)
                                                                                                                                      5x4n − 9x2n + 2

-->

<p>

\begin{equation}
x_{n+1}=x_{n}-\frac {x_{n}^{5}-3x_{n}^3+2x_{n}-4}{5x_{n}^{4}-9x_{n}^{2}+2}.
\end{equation}

</p>

<p>
Starting from \(x_{0}=1.8\) we get the sequence in table&nbsp;<a href="Numerical-Methods.html#table:3">6.4</a>. This iteration scheme converges to the precise answer of eq.&nbsp;<span class="textup">(<a
href="Numerical-Methods.html#eq: precise root">6.2</a>)</span> much quicker than the other methods.
</p>

<p>
Newton’s method is the approach that you need to be able to use during this module so we will treat a couple more examples using it. There are a couple more examples on <a id="mat1001-autopage-230"></a>[Dawkins, 2025a] if you want to see more.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-231"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.4</span></span>. </span> Use Newton’s method to determine an approximation to the solution to \(\sin {x} = -x\) that lie in the interval \([-1,1]\).
Find the approximation to \(6\) decimal places.<br />


</p>

<p>
First we need to pick a starting point \(x_{0}\). Here we will take \(x_{0}=0.5\), you can get an idea of what value to pick by plotting the function. For this example we have that
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{5}\)</span>

<!--


                                                                                         f (x) = sin(x) + x = 0,                                                                           (6.6)                   --><a id="eq:   sin +x roots"></a><!--

-->

<p>


\begin{equation}
f(x)=\sin (x)+x=0, \label {eq:     sin +x roots}
\end{equation}


</p>

<p>
so the iteration equation for Newton’s method eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:          Newton iteration scheme">6.4</a>)</span> becomes
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{6}\)</span>

<!--


                                                                                                                                        sin xn + xn
                                                                                                                         xn+1 = xn −                .
                                                                                                                                         cos xn + 1

-->

<p>


\begin{equation*}
x_{n+1}=x_{n}-\frac {\sin {x_{n}}+x_{n}}{\cos {x_{n}}+1}.
\end{equation*}


</p>

<p>
The first approximation is then
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{6}\)</span>

<!--


                                                                                                                            1   sin 12 + 12
                                                                                                                     x1 =     −             = −0.0216418
                                                                                                                            2   cos 12 + 1

-->

<p>


\begin{equation*}
x_{1}=\frac {1}{2}-\frac {\sin {\frac {1}{2}}+\frac {1}{2}}{\cos {\frac {1}{2}}+1}=-0.0216418
\end{equation*}


</p>

<figure id="autoid-38" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.5: Successive approximations to the root of eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:   sin +x roots">6.6</a>)</span> using Newton’s method.

</div>

<a id="table:4"></a>
<table>

<tr style="display:none"><th>.</th></tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:        1px solid black; border-right:      1px solid black">\(n\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(x_{n}\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(f(x_{n})\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:        1px solid black; border-right:      1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(0.5\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(0.979426\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:        1px solid black; border-right:      1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(-0.021642\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(-0.043282\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:        1px solid black; border-right:      1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(2\times 10^{-6}\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(3.\times 10^{-6}\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:        1px solid black; border-right:      1px solid black">\(3\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(0\)</td>
</tr>


<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<p>
The further iteration steps are shown in table&nbsp;<a href="Numerical-Methods.html#table:4">6.5</a>, and we see that to 6 decimal places, it only takes \(4\) iterative steps to find that the root is at \(x=0\). If we did any more steps we would see that these remain
at \(x=0\).
</p>

</li>

</ul>

</div>

<p>
Now we can consider one of the examples from <a id="mat1001-autopage-233"></a>[Dawkins, 2025a] which shows when Newton’s method does not work.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-234"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.5</span></span>. </span> Starting from \(x_{0}=1\) we will apply Newton’s method to \(\sqrt [3]{x}\).<br />


</p>

<p>
Intuitively it is clear that the root is \(x=0\). However, Newton’s method will not find this root. For this example eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:     Newton iteration scheme">6.4</a>)</span> becomes
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{6}\)</span>

<!--

                                                                                                                                √
                                                                                                                                3
                                                                                                                                    x
                                                                                                                xn+1 = xn −             = xn − 3xn = −2xn .
                                                                                                                              1 −2
                                                                                                                              3
                                                                                                                                x 3

-->

<p>


\begin{equation*}
x_{n+1}=x_{n}-\frac {\sqrt [3]{x}}{\frac {1}{3}x^{-\frac {2}{3}}}=x_{n}-3x_{n}=-2x_{n}.
\end{equation*}


</p>

<p>
This already tells us that instead of converging to \(x=0\), Newton’s method will diverge with \(x_{1}=-2\), \(x_{2}=4\), \(x_{3}=-8\), \(x_{4}=16\), &#x2026;. This is the opposite of what we want. Fortunately, it became obvious quite quickly that the method was not
working and we did not have to waste much time before discovering that we needed to used a different model.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-235"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.6</span></span>. </span> Write a computer program to implement Newton’s method and use it to find the roots in the examples above, where Newton’s
method works.
</p>

</li>

</ul>

</div>
<!--
...... subsection Secant method ......
-->
<h5 id="autosec-236">Secant method</h5>
<a id="mat1001-autopage-236"></a>


<p>
A variant of Newton’s method is the <b>Secant</b> method, where we start with two estimates of the root, \(x_{0}\) and \(x_{1}\) and estimate the derivative as being the Newton quotient
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{6}\)</span>

<!--

                                                                                                                                            f (x1 ) − f (x1 )
                                                                                                                            Q(x0 , x1 ) =                     ,
                                                                                                                                                x1 − x 0

-->

<p>

\begin{equation*}
Q(x_{0},x_{1})=\frac {f(x_{1})-f(x_{1})}{x_{1}-x_{0}},
\end{equation*}

</p>

<p>
so that
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{6}\)</span>

<!--

                                                                                                                                    f (x1 )               f (x1 )
                                                                                                                    x2 = x 1 −                 = x1 − f (x )−f (x ) .
                                                                                                                                   Q(x0 , x1 )            1       1
                                                                                                                                                           x1 −x0

-->

<p>

\begin{equation*}
x_{2}=x_{1}-\frac {f(x_{1})}{Q(x_{0},x_{1})}=x_{1}-\frac {f(x_{1})}{\frac {f(x_{1})-f(x_{1})}{x_{1}-x_{0}}}.
\end{equation*}

</p>

<p>
This means that the iteration scheme is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{6}\)</span>

<!--

                                                                                             f (xn )                f (xn )
                                                                            xn+1 = xn −                 = xn − f (x )−f (x                                                                                 (6.7)               --><a id="eq:   secant method"></a><!--
                                                                                          Q(xn−1 , xn )            n       n−1 )
                                                                                                                   xn −xn−1

-->

<p>

\begin{equation}
x_{n+1}=x_{n}-\frac {f(x_{n})}{Q(x_{n-1},x_{n})}=x_{n}-\frac {f(x_{n})}{\frac {f(x_{n})-f(x_{n-1})}{x_{n}-x_{n-1}}} \label {eq:                            secant method}
\end{equation}

</p>

<p>
Geometrically, the secant method can also be viewed as constructing a line nearby our function and moving to the point where this line cuts the \(x\)-axis. However, this line is no longer a tangent line, but is a secant.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-237"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.7</span></span>. </span> For
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{7}\)</span>

<!--


                                                                                                                          f (x) = x2 − 10,

-->

<p>


\begin{equation*}
f(x)=x^{2}-10,
\end{equation*}


</p>

<p>
and taking \(x_{0}=2\), \(x_{1}=3\) we find \(x_{2}\) using the secant method as follows:
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{7}\)</span>


<!--



                                                                                                                                    f (x1 )
                                                                                                                      x2 = x1 − f (x )−f (x )
                                                                                                                                      1        0
                                                                                                                                      x1 −x0
                                                                                                                                 −1
                                                                                                                         = 3 − −1−(−6)
                                                                                                                                  3−2
                                                                                                                             1
                                                                                                                         =3+
                                                                                                                             7
                                                                                                                         = 3.14286.



-->


<p>


\begin{align*}
x_{2}&amp;=x_{1}-\frac {f(x_{1})}{\frac {f(x_{1})-f(x_{0})}{x_{1}-x_{0}}}\\ &amp;=3-\frac {-1}{\frac {-1-(-6)}{3-2}}\\ &amp;=3+\frac {1}{7}\\ &amp;=3.14286.
\end{align*}
This is an equation that we can solve directly by the rearrangement method since \(f(x)=0\) corresponds to \(x^{2}=10\) so the exact answers are \(x=-\sqrt {10}\simeq -3.16228\) and \(x=\sqrt {10}\simeq 3.16228\). We can see that \(x_{2}\) is already
approaching this exact answer.
</p>

<p>


</p>

</li>

</ul>

</div>
<!--
...... subsection Convergence and errors ......
-->
<h5 id="autosec-238">Convergence and errors</h5>
<a id="mat1001-autopage-238"></a>


<p>
The absolute error of a numerical method is the difference between the true solution \(x\) and the approximate solution \(\xi \), \(\epsilon =\vert x-\xi \vert \). It can be hard to estimate the absolute error unless we already know the exact solution.<br />

</p>

<p>
We say that an iteration scheme converges when it subsequent iterations do not change the value of \(x_{n}\), at least to the accuracy that we are looking for. Not every method will converge for a given problem, We have already seen that Newton’s method does not
converge for the cube root, \(\sqrt [3]{x}\). You will gain experience of which methods works best for which type of of problem. In this module, you will mainly be using Newton’s method so you need to remember that it can fail.
</p>
<!--
...... section Approximating functions ......
-->
<h4 id="autosec-239"><span class="sectionnumber">6.2&#x2003;</span>Approximating functions</h4>
<a id="mat1001-autopage-239"></a>


<p>
Through much of this module we have been discussing functions and how to work with them. Now we will look at a method for approximating functions using polynomials. This is one of the reasons that we spent so long discussing polynomials at the start. If we can
understand polynomials then we can get a good idea of how many functions behave.<br />

</p>

<p>
In essence this function is all about fitting data points, or establishing if there is a relationship or trend between known data. We are not framing it like this here but if you go on to take any statistics or data analysis modules then the approximation ideas here will prove
useful to you.
</p>

<p>
If we have time, in chapter&nbsp;<a href="Advanced-Topics.html#sec:advanced topics">8</a> we will discuss the continuous analogue of this which goes by the name of the <b>Taylor</b> or <b>Maclaurin</b> series. However, to understand these properly, we need
to know how to calculate multiple derivative, which is just at the edge of what is included in this module. In this section we will be doing this using two discrete methods, one known as the <b>Newton interpolating polynomial</b>, or <b>Newton’s divided
difference method</b>, and the other <b>Lagrange’s method</b>.
</p>
<!--
...... subsection Newton’s method ......
-->
<h5 id="autosec-240">Newton’s method</h5>
<a id="mat1001-autopage-240"></a>


<p>
The idea is that idea is that given some values of a function, we can find a polynomial which passes through them. The example given in Lissamen and West [2004] is to consider the growth rate per year for a group of young people. The results are given in table&nbsp;<a
href="Numerical-Methods.html#table:heights">6.6</a> and can be plotted as five points on a graph. The question asked, and answered, in Lissamen and West [2004] is can a formula be found which fits all of these points. The formula given in Lissamen and West [2004] is
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{7}\)</span>

<!--


                                                                                               f (x) = 4.13984375 + 3.34791667x − 0.91315104x2 + 0.08177083x3 − 0.00232747x4 .

-->

<p>

\begin{equation*}
f(x)=4.13984375+3.34791667x-0.91315104x^{2}+0.08177083x^{3}-0.00232747x^{4}.
\end{equation*}

</p>

<p>
The intuition behind this is that we first guess that the function has the form of a straight line \(f(x)=mx+c\), notice that this does not fit the data, then add higher order monomials such as \(x^{2},x^{3},x^{4}\) with appropriate sized coefficients until we get the
correct shape and the curve passes through, or close to, the points.<br />

</p>

<p>
By the end of this section you will know how to calculate the approximate function which fits the given data.<br />

</p>

<figure id="autoid-39" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.6: Measurements of the average height increase per year at various ages taken from <a id="mat1001-autopage-241"></a>Lissamen and West [2004].

</div>

<a id="table:heights"></a>
<table>

<tr style="display:none"><th>.</th></tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">Age in years</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(6\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(10\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(14\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(18\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">Rate of Growth in cm per year</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(7.8\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(6.0\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(4.8\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(7.0\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(1.1\)</td>
</tr>

<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<figure id="autoid-40" class="figure ">
<div class="center">

<p>
<span
    id="lateximage-mat1001-22"
    class="lateximagesource"
><!--
Growth rate (cm per year)




                            Age (years)
--><img
    src="mat1001-images\image-22.svg"
    alt="(Graph of the function that fits the heights.)"
    style=""
    class="lateximage"
></span>
</p>


<div class="figurecaption">
Figure&nbsp;6.4: A plot of the function which fits the heights from table&nbsp;<a href="Numerical-Methods.html#table:heights">6.6</a> with an approximate polynomial fitted. The polynomial does not quite go through all of the points but passes close to all of them,
this is an artefact of the plot being scaled, This will be fixed soon.

</div>

<a id="fig:    heights fit"></a>

</div>

</figure>

<p>
Following <a id="mat1001-autopage-245"></a>Lissamen and West [2004], we will use the notation in table&nbsp;<a href="Numerical-Methods.html#table:notation">6.7</a>. We start our labelling from the left most point and moving rightwards until we get to the last
point. Here we are taking \(x\) values that have a constant spacing which we denote by \(h\)<sup>3</sup>.<br />

</p>

<figure id="autoid-41" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.7: Our standard notation for putting a list of \(n\) points and the values the true function takes at these points into a table.

</div>

<a id="table:notation"></a>
<table>

<tr style="display:none"><th>.</th></tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:                  1px solid black">\(x\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{0}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{1}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{2}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{3}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{4}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">&#x2026;</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(x_{n}\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:                  1px solid black">\(f(x)\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{0})\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{1})\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{2})\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{3})\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{4})\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">&#x2026;</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f(x_{n})\)</td>
</tr>

<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<p>
One approach to finding the polynomial is via a finite difference table. This is a means of keeping track of the points, the values of the function at the points, the differences between the values of the function at neighbouring points, the differences between the differences,
and so on.<br />

</p>

<p>
As usual we take \(\Delta \) to mean the change in some quantity. Here it is technically being used to denote the <b>forward difference operator</b>,
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{7}\)</span>

<!--


                                                                    ∆f0 = f1 − f0 ,   ∆f1 = f2 − f1 ,   . . . , ∆fn−1 = fn − fn−1 .                                                                   (6.8)                       --><a id="eq:     forward differences"></a><!--

-->

<p>

\begin{equation}
\Delta f_{0}=f_{1}-f_{0}, \quad \Delta f_{1}=f_{2}-f_{1}, \quad \dots , \Delta f_{n-1}=f_{n}-f_{n-1}.                   \label {eq:    forward differences}
\end{equation}

</p>

<p>
This is called the forward difference because it is defined as \(f_{1}-f_{2}\), e.g we subtract the value of the function at the point on the left from the value at the point on the left. There is a corresponding <b>backward difference operator</b> coming from
considering \(f_{0}-f_{1}\). We will not consider backwards differences here, but you can come up with an alternative method using them. If you go into numerical analysis, or solving real world problems by writing computer programmes then you will need to be
familiar with both methods.<br />

</p>

<p>
The differences between differences are then denoted
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{8}\)</span>

<!--


                                                                                                                   ∆2 f0 = ∆f1 − ∆f0 ,    ∆2 f1 = ∆f2 − ∆f1 , . . . .                                                                                                            (6.9)

-->

<p>

\begin{equation}
\Delta ^{2}f_{0}=\Delta f_{1}-\Delta f_{0}, \quad \Delta ^{2}f_{1}=\Delta f_{2}-\Delta f_{1}, \dots .
\end{equation}

</p>

<p>
If we wanted to we can keep going with differences of differences of differences etc. How far you go will depend on the specific problem, as well as how precise you want your approximation to be.
</p>

<p>
A convenient way to keep track of everything is to put it all in a table as in table&nbsp;<a href="Numerical-Methods.html#table:         fd1">6.8</a> which has four points and works up to third order differences \(\Delta ^{3}f_{i}\). If we wanted to include more
differences then we would need to add more columns.
</p>

<figure id="autoid-42" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.8: A finite difference table with four points working up to the third differences.

</div>

<a id="table:    fd1"></a>
<table>

<tr style="display:none"><th>.</th></tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black">\(x_{i}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f_{i}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta f_{i}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta ^{2} f_{i}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta ^{3}f_{i}\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(x_{0}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f_{1}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta f_{0}=f_{1}-f_{0}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black">\(x_{1}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f_{1}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta ^{2}f_{0}=\Delta f_{1}-\Delta f_{0} \)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta f_{1}=f_{2}-f_{1}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta ^{3}f_{0}=\Delta ^{2}f_{1}-\Delta ^{2}f_{0}\)</td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black">\(x_{2}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f_{2}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta ^{2}f_{1}=\Delta f_{2}-\Delta f_{1}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(\Delta f_{2}=f_{3}-f_{2}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left: 1px solid black; border-right:   1px solid black">\(x_{3}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black">\(f_{3}\)</td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
<td class="tdc tvertbarr" style="border-right: 1px solid black"></td>
</tr>

<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>
<div role="note" class="footnotes">

<a id="mat1001-autopage-250"></a>

<p>
<sup>3</sup>&nbsp;If this seems suggestive of our notation when doing differentiation from first principles, that is on purpose. The separation between points is precisely what we want to take to zero to get the derivative.
</p>


</div>



<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker">
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.8</span></span>. </span> If we consider the data in table&nbsp;<a href="Numerical-Methods.html#table:heights">6.6</a> and work to fourth order
differences we get the table in table&nbsp;<a href="Numerical-Methods.html#table:       fd ex1">6.9</a>. This finite difference table is what we can use to construct the approximate function.
</p>
<figure id="autoid-43" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.9: A finite difference table with four points working up to the third differences for the data in table&nbsp;<a href="Numerical-Methods.html#table:heights">6.6</a>.

</div>

<a id="table:   fd ex1"></a>
<table>

<tr style="display:none"><th>.</th></tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(x_{i}\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(f_{i}\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(\Delta f_{i}\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(\Delta ^{2} f_{i}\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(\Delta ^{3}f_{i}\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(7.8\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(6-7.8 =-1.8\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(4\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(6\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0-(-1.8)=1.8\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(6-6=0\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0.5-1.8=-1.3\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(6\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(6\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0.5-0=0.5\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(6.5-6=0.5\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(8\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(6.5\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-253"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.9</span></span>. </span> Consider the quadratic function \(f(x)=x^{2}+1\), working up to fourth order differences, this gives the finite difference table in
table&nbsp;<a href="Numerical-Methods.html#table:    fd ex2">6.10</a>. Notice that the third and fourth differences all vanish.
</p>

<figure id="autoid-44" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.10: A finite difference table with four points working up to the fourth order differences for the function \(f(x)=x^{2}+1\).

</div>

<a id="table:    fd ex2"></a>
<table>

<tr style="display:none"><th>.</th></tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(x_{i}\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(f_{i}\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(\Delta f\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(\Delta ^{2} f\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(\Delta ^{3}f\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(\Delta ^{4}f\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(3\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(5\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(5\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(3\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(10\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(7\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:   1px solid black">\(4\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(17\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black"></td>
</tr>


<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-256"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.10</span></span>. </span> Construct the finite difference table, up to third order differences, for the linear function \(f(x)=2x+1\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-257"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.11</span></span>. </span> Construct the finite difference table, up to third order differences, for a cubic function of your choice. How many differences do
you think you need to include?
</p>

</li>

</ul>

</div>

<p>
It is a general property of polynomials that for a polynomial with highest order term \(x^{n}\), the \(n\)’th differences will be constant and all higher order differences will vanish.
</p>

<p>
The polynomial built from the finite difference table is known as the interpolating polynomial. This gives the interpolating, or approximating function as
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{9}\)</span>

<!--

                                                                             x − x0       (x − x0 )(x − x1 ) 2     (x − x0 )(x − x1 )(x − x2 ) 3
                                                              f (x) = f0 +          ∆f0 +                   ∆ f0 +                            ∆ f0 + . . . ,                                                 (6.10)                    --><a id="eq:   NIP"></a><!--
                                                                               h                2!h2                          3!h3
-->

<p>

\begin{equation}
f(x)=f_{0}+\frac {x-x_{0}}{h}\Delta f_{0}+\frac {(x-x_{0})(x-x_{1})}{2!h^{2}}\Delta ^{2}f_{0}+\frac {(x-x_{0})(x-x_{1})(x-x_{2})}{3!h^{3}}\Delta ^{3}f_{0}+\dots , \label {eq:                       NIP}
\end{equation}

</p>

<p>
with \(h\) the constant spacing between the \(x\) values.<br />

</p>

<p>
This may look complicated, but there is a set pattern to the terms, and the sum will terminate, either when all of the \(\Delta ^{a}f_{0}=0\) or because of the number of data points we are given.<br />

</p>

<p>
When we only have two points this method is called <b>linear interpolation</b> as only the first two terms in eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:           NIP">6.10</a>)</span> are non-zero.<br />

</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-258"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.12</span></span>. </span> Consider the finite difference table in table&nbsp;<a href="Numerical-Methods.html#table:   fd ex2">6.10</a>. The
corresponding Newton interpolating polynomial is found as follows:
</p>
<ul class="itemize" style="list-style-type:none">


<li>
<p>
<span class="listmarker">•</span> \(h=1\),
</p>


</li>
<li>


<p>
<span class="listmarker">•</span> \(\Delta f_{0}=1\),<br />


</p>


</li>
<li>


<p>
<span class="listmarker">•</span> \(\Delta ^{2}f=2\),<br />


</p>


</li>
<li>


<p>
<span class="listmarker">•</span> \(\Delta ^{3}f=0\),
</p>
</li>
</ul>

<p>
and we know what the \(x_{i}\) are, so we can substitute everything in to find:
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>


<!--



                                                                                                                               x(x − 1)
                                                                                                             f (x) = 1 + x +            2
                                                                                                                                  2
                                                                                                                  = 1 + x − x + x2 = 1 + x2 .



-->


<p>


\begin{align*}
f(x) &amp;= 1+x+\frac {x(x-1)}{2}2\\ &amp;=1+x-x+x^{2}=1+x^{2}.
\end{align*}
This is the polynomial that we started with which is a good sign.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-259"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.13</span></span>. </span> Consider the finite difference table in table&nbsp;<a href="Numerical-Methods.html#table:   fd ex1">6.9</a>, and find the
Newton interpolation polynomial for this data.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-260"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.14</span></span>. </span> Consider the data in table&nbsp;<a href="Numerical-Methods.html#table:   data table for exercise">6.11</a> and find the
polynomial that fits the data.
</p>
<figure id="autoid-45" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.11: A table of data that you need to find the Newton polynomial for.

</div>

<a id="table:   data table for exercise"></a>
<table>

<tr style="display:none"><th>.</th></tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(x\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(3\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(4\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(5\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:         1px solid black; border-right:       1px solid black">\(f(x)\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(2\)</td>
</tr>


<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<p>
Then use your approximation to find the value of \(f(4.3)\).
</p>

</li>

</ul>

</div>

<p>
Note that if all of the differences of a given order are approximately constant then we can sometimes get away with a lower order polynomial approximation, even if the higher order terms do not actually vanish.
</p>
<!--
...... subsection Lagrange’s method ......
-->
<h5 id="autosec-263">Lagrange’s method</h5>
<a id="mat1001-autopage-263"></a>


<p>
There is an alternative method due to Lagrange, where we do not need to start with equally spaced points. The easiest way to understand this method is to start by considering the linear case, then the quadratic case, before giving the general expression. This is also
discussed briefly in Lissamen and West [2004].<br />

</p>

<p>
The linear case of Lagrange’s equation is very similar to eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:            linear interpolation formula">6.3</a>)</span> that we met when discussing linear interpolation as a method of root finding.<br />

</p>

<p>
Given two points \((a,A)\) and \((b,B)\), the straight line that passes through them is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                                    A(x − b)   B(x − a)
                                                                                                                          f (x) =            +
                                                                                                                                     a−b        b−a

-->

<p>

\begin{equation*}
f(x)=\frac {A(x-b)}{a-b}+\frac {B(x-a)}{b-a}
\end{equation*}

</p>

<p>
where we need that \(a\neq b\).<br />

</p>

<p>
If we have three points, \((a,A), (b,B), (c,C)\) then they lie on a quadratic given by
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                  A(x − b)(x − c)   B(x − c)(x − a)   C(x − a)(x − b)
                                                                                                        f (x) =                   +                 +                 ,
                                                                                                                   (a − b)(a − c)    (b − c)(b − a)    (c − a)(c − b)

-->

<p>

\begin{equation*}
f(x)=\frac {A(x-b)(x-c)}{(a-b)(a-c)}+\frac {B(x-c)(x-a)}{(b-c)(b-a)}+\frac {C(x-a)(x-b)}{(c-a)(c-b)},
\end{equation*}

</p>

<p>
where we now need that \(a,b,c\) are non equal.<br />

</p>

<p>
This approach can be generalised to a polynomial going through \(n\) points. This will be a polynomial of degree \(n-1\) for \(n\) points.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-264"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.15</span></span>. </span> Find the expression for the degree \(3\) polynomial going through four points, then use the pattern that you can see between the
line, quadratic, and cubic, cases to find the general expression for the polynomial passing through \(n\) points.
</p>

</li>

</ul>

</div>
<!--
...... section Numerical integration ......
-->
<h4 id="autosec-265"><span class="sectionnumber">6.3&#x2003;</span>Numerical integration</h4>
<a id="mat1001-autopage-265"></a>


<p>
<span
    class="textcolor"
    style="color:#FF0000"
>This section needs more images added. There are graphs for the mid point rule case but not for the trapezium rule case. These will be added soon.</span>
</p>

<p>
We now turn to numerical methods of integration. We have already carried out some numerical integration when we discussed definite integrals and the relationship between integrals and sums. In fact the first method we will use to carry out numerical integration, the
<b>midpoint rule</b>, is one we have already seen. We will also discuss two other related rules that estimate the area under a graph, the <b>trapezium rule</b> and <b>Simpson’s rule</b>. These are not independent methods, and Simpson’s rule is actually a
weighted average of the mid point and trapezium rule which improves the accuracy.<br />

</p>

<p>
In practice, when you ask a computer to carry out a definite integration, unless you use a symbolic computation method in <b>Maple</b>, <b>Mathematica</b>, or similar, the computer will be implementing one of these rules. This means that by understanding how
they work and how to implement them by hand, you will be able to code up your own numerical integrator. I recommend this as a challenge to an keen students who want to make practical use of what you are learning in this module and I will put an exercise at the end of
each section suggesting that you do this for each of the rules.
</p>
<!--
...... subsection Midpoint rule ......
-->
<h5 id="autosec-266">Midpoint rule</h5>
<a id="mat1001-autopage-266"></a>


<p>
The mid point rule is the approximation approach that we met in chapter&nbsp;<a href="Integration.html#sec:integration">4</a> when approximating the area under the curve for the function \(f(x)=x^{2}+1\). Let’s recap it here.<br />

</p>

<p>
Consider the figure in fig.&nbsp;<a href="Numerical-Methods.html#fig:   first integral approx">6.5</a>, as we saw earlier we will be approximating the area between the curve and the \(x\)-axis, using rectangles of width \(\Delta x\) and height \(\Delta y\).
</p>

<figure id="autoid-46" class="figure ">
<div class="center">

<p>
<span
    id="lateximage-mat1001-23"
    class="lateximagesource"
><!--
    y




1


        2   x
    0
--><img
    src="mat1001-images\image-23.svg"
    alt="(Graph of the function x squared plus one.)"
    style=""
    class="lateximage"
></span>
</p>


<div class="figurecaption">
Figure&nbsp;6.5: A plot of our favourite function \(f(x)=x^{2}+1\).

</div>

<a id="fig:    first integral approx"></a>

</div>

</figure>

<p>
As before, w e do this by splitting up the interval, \([0,2]\) in this case, into \(n\) subintervals. This will give us an approximation of the area which will improve the more sub integrals we take, in other words the larger that \(n\) is. The width of a subinterval is then
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                                        2−0  2
                                                                                                                                 ∆x =       = .
                                                                                                                                         n   n
-->

<p>

\begin{equation*}
\Delta x=\frac {2-0}{n}=\frac {2}{n}.
\end{equation*}

</p>

<p>
In general it will be \(\Delta x=(b-a)/n\), when the interval is \([a,b]\).<br />

</p>

<p>
Before we said that we could pick the height of the intervals to be any value the function takes within the sub interval. As the numerical approach that we are following is called the midpoint rule, unsurprisingly, we take the height to be the value of the function at the
midpoint of the subinterval. Recall that for an interval \([a,b]\) the midpoint is \(c=(a+b)/2\). This method is shown in ??.
</p>

<figure id="autoid-47" class="figure ">
<div class="center">

<p>
<span
    id="lateximage-mat1001-24"
    class="lateximagesource"
><!--
    y




1


        2   x
    0
--><img
    src="mat1001-images\image-24.svg"
    alt="(Graph of the function x squared plus one with rectangles approximating the area under the curve.)"
    style=""
    class="lateximage"
></span>
</p>


<div class="figurecaption">
Figure&nbsp;6.6: A plot of \(f(x)=x^{2}+1\) with rectangles approximating the area under the curve.

</div>

<a id="fig:    approximate area mid point "></a>

</div>

</figure>

<p>
As we are taking four subintervals they are
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                              1         1                3             3
                                                                                                                       h       i    h        i      h     i        h      i
                                                                                                                         0,     ,         ,1 ,      1,     ,             ,2 ,
                                                                                                                              2         2                2             2

-->

<p>

\begin{equation*}
\left [0,\frac {1}{2}\right ], \quad \left [\frac {1}{2},1\right ], \quad \left [1,\frac {3}{2}\right ], \quad \left [\frac {3}{2},2\right ],
\end{equation*}

</p>

<p>
which all have width \(\Delta x=1/2\). The heights are
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                              1        17           3        25          5          41          7       65
                                                                                                                                                                       
                                                                                                         f         =      ,    f         =      ,   f          =       ,f           =      .
                                                                                                              4        16           4        16          4          16          4       16

-->

<p>

\begin{equation*}
f\left (\frac {1}{4}\right )=\frac {17}{16}, \quad f\left (\frac {3}{4}\right )=\frac {25}{16}, \quad f\left (\frac {5}{4}\right )=\frac {41}{16}, f\left (\frac {7}{4}\right )=\frac {65}{16}.
\end{equation*}

</p>

<p>
The area of each rectangle is then
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>


<!--


                                                                                                                                     1   1  17   17
                                                                                                                                              
                                                                                                                        A1 = ∆x × f     = ×    =    ,
                                                                                                                                     4   2  16   32
                                                                                                                                     3   1  25   25
                                                                                                                                     
                                                                                                                        A2 = ∆x × f     = ×    =    ,
                                                                                                                                     4   2  16   32
                                                                                                                                     5   1  41   41
                                                                                                                                     
                                                                                                                        A3 = ∆x × f     = ×    =    ,
                                                                                                                                     4   2  16   32
                                                                                                                                     7   1  65   65
                                                                                                                                     
                                                                                                                        A4 = ∆x × f     = ×    =    .
                                                                                                                                     4   2  16   32


-->


<p>

\begin{align*}
A_{1}&amp;=\Delta x\times f\left (\frac {1}{4}\right )=\frac {1}{2}\times \frac {17}{16}=\frac {17}{32},\\ A_{2}&amp;=\Delta x\times f\left (\frac {3}{4}\right )=\frac {1}{2}\times \frac {25}{16}=\frac {25}{32},\\ A_{3}&amp;=\Delta
x\times f\left (\frac {5}{4}\right )=\frac {1}{2}\times \frac {41}{16}=\frac {41}{32},\\ A_{4}&amp;=\Delta x\times f\left (\frac {7}{4}\right )=\frac {1}{2}\times \frac {65}{16}=\frac {65}{32}.
\end{align*}

</p>

<p>
The total area, \(A_{m}\) since we are using the midpoint rule, is thus
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                                         17   25   41   65   148   37
                                                                                                  Am = A 1 + A 2 + A 3 + A 4 =              +    +    +    =     =    ≃ 4.625.
                                                                                                                                         32   32   32   32   32    8
-->

<p>

\begin{equation*}
A_{m}=A_{1}+A_{2}+A_{3}+A_{4}=\frac {17}{32}+\frac {25}{32}+\frac {41}{32}+\frac {65}{32}=\frac {148}{32}=\frac {37}{8}\simeq 4.625.
\end{equation*}

</p>

<p>
This was a result that we quoted in chapter&nbsp;<a href="Integration.html#sec:integration">4</a>, but did not give all the details for. We also commented on the fact that this was pretty close to the true value of \(A=14/3=4.67\) found by carrying out the definite
integral.<br />

</p>

<p>
This shows that we do not always need to use that many sub intervals to get a decent estimate of the integral using the midpoint rule.<br />

</p>

<p>
We have given one example here, and you have checked at least one more on the problem sheets. However, this idea is general.<br />

</p>

<p>
Given a function \(f(x)\) and an interval \([a,b]\) you should use the following steps:
</p>
<ul class="itemize" style="list-style-type:none">

<li>
<p>
<span class="listmarker">•</span> pick a number of sub intervals, or use the number given in the question, \(n\), and split your interval into \(n\) sub intervals \([a_{0},a_{1}], [a_{1},a_{2}], \dots [a_{n-1},a_{n}]\), of fixed width \(\Delta x =(b-a)/n\).
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> find the mid point of each sub interval \(c_{i}=(a_{i}-a_{i-1})/2\) and take the height of the rectangle to be the value of the function at this point, \(\Delta y_{i}=f(c_{i})\).
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> Calculate the area of each of the rectangles as \(A_{i}=\Delta x \times \Delta y_{i}\).<br />

</p>

</li>
<li>

<p>
<span class="listmarker">•</span> Sum up all of the areas of the rectangles and get your estimate of the total area
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>
<!--
                                                                                                                                                          n
                                                                                                                                                          X
                                                                                                                              Am = A 1 + . . . A n =               Ai .
                                                                                                                                                             i=1
-->
<p>

\begin{equation*}
A_{m}=A_{1}+\dots A_{n}=\sum _{i=1}^{n}A_{i}.
\end{equation*}

</p>
<p>
and use this as your approximation to the definite integral.
</p>
</li>
</ul>

<p>
In essence we are treating the problem the opposite way round to in chapter&nbsp;<a href="Integration.html#sec:integration">4</a>, where we used this approximate picture and discussed how this became the definite integral in the limit of an infinite number of very
thin rectangles. Here we are saying that we can use a finite number of rectangles to estimate the definite integral.<br />

</p>

<p>
Note that in many of the cases you are asked about here you can also compute the integrals directly. This enables you to check how close your answer is to the true answer. The real power of this method is that you can approximate the value of integrals that cannot be
calculated directly. or which are very hard to calculate directly.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-273"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.16</span></span>. </span> Consider the definite integral
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                                 Z 1p
                                                                                                                            I=          x3 + 1dx,
                                                                                                                                 0

-->

<p>


\begin{equation*}
I=\int _{0}^{1}\sqrt {x^{3}+1}\ud x,
\end{equation*}


</p>

<p>
we can evaluate this with the midpoint rule for \(n=5\) strips as follows. Since \(n=5\) the width of each strip is \(\Delta x = (1-0)/5=1/5=0.2\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-274"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.17</span></span>. </span> Consider the function \(f(x)=x^{2}-2\) on the interval \([0,2]\). Take \(n=8\) and use the midpoint rule to approximate the
definite integral
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                        Z 2
                                                                                                                                   
                                                                                                                   I=         x2 − 2 dx.
                                                                                                                         0

-->

<p>


\begin{equation*}
I=\int _{0}^{2}\left (x^{2}-2\right )\ud x.
\end{equation*}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-275"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.18</span></span>. </span> Consider the function \(f(x)=x^{3}+x^{2}-x-1\) on the interval \([-1,1]\). Take \(n=6\) and use the midpoint rule to
approximate the definite integral
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                    Z 1
                                                                                                                                        
                                                                                                               I=         x3 + x2 − x − 1 dx.
                                                                                                                     −1

-->

<p>


\begin{equation*}
I=\int _{-1}^{1}\left (x^{3}+x^{2}-x-1\right )\ud x.
\end{equation*}


</p>

<p>
How does this compare to calculating the definite integral directly?
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-276"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.19</span></span>. </span> Consider the function \(f(x)=\sin (x)\) on the interval \([0,\uppi ]\). Take \(n=8\) and use the midpoint rule to
approximate the definite integral
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                          Z π
                                                                                                                     I=         sin(x)dx.
                                                                                                                           0

-->

<p>


\begin{equation*}
I=\int _{0}^{\uppi }{\sin (x)}\ud x.
\end{equation*}


</p>

<p>


</p>

</li>

</ul>

</div>
<!--
...... subsection Trapezium rule ......
-->
<h5 id="autosec-277">Trapezium rule</h5>
<a id="mat1001-autopage-277"></a>


<p>
The next rule is known as the trapezium rule. It is very similar to the midpoint rule in that we are approximating the area under the curve using shapes that we know how to calculate the area of. However, here we use trapezia instead of rectangles.<br />

</p>

<p>
A trapezium is like a rectangle glued onto a triangle, in general it is a four sided shape where at least one pair of sides are parallel. So squares and rectangles are examples of trapezia.<br />

</p>

<p>
Consider a function \(f(x)\) on the interval \([a,b]\). If the length of the left edge of the trapezium is \(f(a)\) and the length of the right edge is \(f(a+\Delta x)\), while its width is \(\Delta x\), then the area is
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--

                                                                                                                                    ∆x
                                                                                                                          Atrap =      (f (a) + f (a + ∆x)) .
                                                                                                                                     2
-->

<p>

\begin{equation*}
A_{\text {trap}}=\frac {\Delta x}{2}\left (f(a)+f(a+\Delta x)\right ).
\end{equation*}

</p>

<p>
If we have an interval \([a,b]\) that we split into \(n\) sub intervals of width \(\Delta x=(b-a)/n\) as before, then we use \(n\)-trapezia, one for each sub intervals. The side lengths of the trapezia are:
</p>
<ul class="itemize" style="list-style-type:none">

<li>
<p>
<span class="listmarker">•</span> \(f_{0}=f(a)\) for the left most trapezium,
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> \(f_{1}=f(a+\Delta x)\) for the right side of the first sub interval and the left side of the second,
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> \(f_{2}=f(a+2\Delta x)\) for the right side of the second sub interval and the left side of the third, and so on up to
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> \(f_{n}=f(a+n\Delta x)=f(b)\) for the right side of the \(n\)’th sub interval.
</p>
</li>
</ul>

<p>
The area of the trapezia are thus
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>


<!--


                                                                                                                                      ∆x
                                                                                                                               A1 =      (f0 + f1 ) ,
                                                                                                                                       2
                                                                                                                                      ∆x
                                                                                                                               A2 =      (f1 + f2 ) ,
                                                                                                                                       2
                                                                                                                               ......
                                                                                                                                      ∆x
                                                                                                                               An =      (fn−1 + fn ) .
                                                                                                                                       2


-->


<p>

\begin{align*}
A_{1}&amp;=\frac {\Delta x}{2}\left (f_{0}+f_{1}\right ),\\ A_{2}&amp;=\frac {\Delta x}{2}\left (f_{1}+f_{2}\right ),\\ \dots &amp;\dots \\ A_{n}&amp;=\frac {\Delta x}{2}\left (f_{n-1}+f_{n}\right ).
\end{align*}

</p>

<p>
Summing these up gives
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{10}\)</span>

<!--


                                                                                                            AT = A1 + A2 + · · · + An
                                                                                                                  ∆x              ∆x                       ∆x
                                                                                                                =    (f0 + f1 ) +     (f1 + f2 ) + · · · +              fn )
                                                                                                                                                                (fn−1 +(6.11)                                                    --><a id="eq:    trapezium rule"></a><!--
                                                                                                                   2               2                        2
                                                                                                                  ∆x
                                                                                                                =    (f0 + 2 (f1 + f2 + · · · + fn−1 ) + fn ) .
                                                                                                                   2

-->

<p>

\begin{equation}
\begin{split} A_{T} &amp;=A_{1}+A_{2}+\dots +A_{n}\\ &amp;=\frac {\Delta x}{2}\left (f_{0}+f_{1}\right )+\frac {\Delta x}{2}\left (f_{1}+f_{2}\right )+\dots +\frac {\Delta x}{2}\left (f_{n-1}+f_{n}\right )\\ &amp;=\frac {\Delta x}{2}\left
(f_{0}+2\left (f_{1}+f_{2}+\dots +f_{n-1}\right )+f_{n}\right ). \end {split} \label {eq: trapezium rule}
\end{equation}

</p>

<p>
Thus to estimate the integral using the trapezium rule we just need to know the value of the function at the end points of the intervals, and the width of the intervals.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-278"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.20</span></span>. </span> Consider \(f(x)=\cos (x)\) over the interval \([0,\uppi /2]\). In Lissamen and West [2004], they discuss this example for
\(1,2,4\) and \(8\) sub intervals, here we will just treat the case of \(n=4\), so \(\Delta x= \uppi /8\). The easiest way to keep track of the information we need is in a table of points, the boundaries of the interval, and the value of the function at these points. This
table is shown in table&nbsp;<a href="Numerical-Methods.html#table:        trapezium data">6.12</a>. taking these five values of \(f(x)\) and substituting into eq.&nbsp;<span class="textup">(<a
href="Numerical-Methods.html#eq:      trapezium rule">6.11</a>)</span> we get
</p>

<figure id="autoid-48" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.12: A table of data that you need to implement the trapezium rule.

</div>

<a id="table:   trapezium data"></a>
<table>

<tr style="display:none"><th>.</th></tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:        1px solid black; border-right:      1px solid black">\(x\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(\frac {\uppi }{8}\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(\frac {\uppi }{4}\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(\frac {3\uppi }{8}\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(\frac {\uppi }{2}\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:        1px solid black; border-right:      1px solid black">\(f(x)\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(0.92\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(\frac {1}{\sqrt {2}}\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(0.38\)</td>
<td class="tdc tvertbarr" style="border-right:       1px solid black">\(0\)</td>
</tr>


<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<span class="hidden"> \(\seteqnumber{0}{6.}{11}\)</span>


<!--



                                                                                                                       ∆x
                                                                                                                 AT =      (f0 + 2 (f1 + f2 + f3 ) + f4 )
                                                                                                                        2
                                                                                                                                          1
                                                                                                                                                         
                                                                                                                        π
                                                                                                                     =      1 + 2(0.92 + √ + 0.38) + 0
                                                                                                                       16                   2
                                                                                                                     = 0.98,



-->


<p>


\begin{align*}
A_{T} &amp;=\frac {\Delta x}{2}\left (f_{0}+2\left (f_{1}+f_{2}+f_{3}\right )+f_{4}\right )\\ &amp;=\frac {\uppi }{16}\left (1+2(0.92+\frac {1}{\sqrt {2}}+0.38)+0\right )\\ &amp;=0.98,
\end{align*}
which is close to the true value of \(1\).
</p>

</li>

</ul>

</div>

<p>
Note that both the trapezium rule and the midpoint rule can be used to find the area under a curve even if we do not know the form of the function.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-281"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.21</span></span>. </span>
</p>

<p>
Consider that we are given the data in table&nbsp;<a href="Numerical-Methods.html#table:   trapezium data 2">6.13</a>, using just this information we can find
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{11}\)</span>

<!--

                                                                                                                          Z 3
                                                                                                                                f (x)dx,
                                                                                                                            1

-->

<p>


\begin{equation*}
\int _{1}^{3}f(x)\ud x,
\end{equation*}


</p>

<p>
without knowing the form of \(f(x)\) using the trapezium rule.
</p>

<figure id="autoid-49" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.13: A table of data that you need to implement the trapezium rule.

</div>

<a id="table:   trapezium data 2"></a>
<table>

<tr style="display:none"><th>.</th></tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:          1px solid black; border-right:      1px solid black">\(x\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(1\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(1.5\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(2\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(2.5\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(3\)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:          1px solid black; border-right:      1px solid black">\(f(x)\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.41\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.69\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(0.92\)</td>
<td class="tdc tvertbarr" style="border-right:        1px solid black">\(1.10\)</td>
</tr>


<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

<p>
This works as follows. We have \(n=4\) sub intervals defined by the five values of \(x\) we are given. Thus we can use eq.&nbsp;<span class="textup">(<a href="Numerical-Methods.html#eq:   trapezium rule">6.11</a>)</span>, and \(\Delta x=(3-1)/4=1/2\) to find
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{11}\)</span>


<!--



                                                                                                                       ∆x
                                                                                                                   AT =   (f0 + 2 (f1 + f2 + f3 ) + f4 )
                                                                                                                        2
                                                                                                                       1
                                                                                                                      = (0 + 2 (0.41 + 0.69 + 0.92) + 1.10)
                                                                                                                       4
                                                                                                                      = 1.29.



-->


<p>


\begin{align*}
A_{T} &amp;=\frac {\Delta x}{2}\left (f_{0}+2\left (f_{1}+f_{2}+f_{3}\right )+f_{4}\right )\\ &amp;=\frac {1}{4}\left (0+2\left (0.41+0.69+0.92\right )+1.10\right )\\ &amp;=1.29.
\end{align*}


</p>

<p>
Note that we could use Newton’s divided difference method to find an approximation to this function, but we do not need to do this to calculate the integral.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-284"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.22</span></span>. </span> Use the trapezium rule with 6 sub intervals to calculate
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{11}\)</span>

<!--

                                                                                                                          Z π
                                                                                                                             2
                                                                                                                     I=           sin(x)dx.
                                                                                                                           − 2π

-->

<p>


\begin{equation*}
I= \int _{-\frac {\uppi }{2}}^{\frac {\uppi }{2}}\sin (x)\ud x.
\end{equation*}


</p>

<p>
You can do this either by hand, or set up a spread sheet or computer programme to solve this for you.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-285"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.23</span></span>. </span> Use the trapezium rule with 4 steps to approximate the definite integral
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{11}\)</span>

<!--

                                                                                                                          Z 2
                                                                                                                                      
                                                                                                                     I=         x2 + 1 dx
                                                                                                                           0

-->

<p>


\begin{equation*}
I=\int _{0}^{2}\left (x^{2}+1\right )\ud x
\end{equation*}


</p>

<p>
and compare it to the answer that we got using the mid point rule in chapter&nbsp;<a href="Integration.html#sec:integration">4</a>.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-286"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.24</span></span>. </span> Write a computer programme to implement the trapezium rule and use it to check the examples and exercises in this section.
</p>

</li>

</ul>

</div>
<!--
...... subsection Simpson’s rule ......
-->
<h5 id="autosec-287">Simpson’s rule</h5>
<a id="mat1001-autopage-287"></a>


<p>
The final numerical method that we will discuss is Simpson’s rule. This is a weighted average of the trapezium rule and the mid point rule. We could actually consider any weighted average of the the two methods to get an approximation to the definite integral. However,
if we were analysing the error we would see that there is one particular choice which minimises the error and gets as close as possible to the true value of the integral. This is Simpson’s rule,
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{11}\)</span>

<!--

                                                                                       2Am + AT
                                                                                AS =            .                                                                                 (6.12)                                          --><a id="eq:    simpsons rule"></a><!--
                                                                                          3
-->

<p>

\begin{equation}
A_{S}=\frac {2A_{m}+A_{T}}{3}.      \label {eq:   simpsons rule}
\end{equation}

</p>

<p>
Note that here we would use the same number of intervals for both the midpoint rule and the trapezium rule.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-288"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.25</span></span>. </span> Let’s return to one of our favourite examples
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{12}\)</span>

<!--

                                                                                                                                  Z π
                                                                                                                                       2
                                                                                                                             I=            cos(x)dx
                                                                                                                                   0

-->

<p>


\begin{equation*}
I=\int _{0}^{\frac {\uppi }{2}}\cos (x)\ud x
\end{equation*}


</p>

<p>
and calculate this for \(n=4\) sub intervals using Simpson’s rule.<br />


</p>

<p>
The data to calculate this is given in table&nbsp;<a href="Numerical-Methods.html#table:   trapezium data">6.12</a>, though we need to find the value of the function at the midpoints for the midpoint rule. We already know that \(A_{T}=0.98\) so we just need to
find \(A_{m}\). The four mid points and the value of the function at them are:
</p>

<ul class="itemize" style="list-style-type:none">


<li>
<p>
<span class="listmarker">•</span> \(c_{0}=(\uppi /8 +0)/2=\uppi /16\) and \(\cos (c_{0})=0.98\)
</p>


</li>
<li>


<p>
<span class="listmarker">•</span> \(c_{1}=(\uppi /4 +\uppi /8)/2=3\uppi /16\) and \(\cos (c_{1})=0.83\),<br />


</p>


</li>
<li>


<p>
<span class="listmarker">•</span> \(c_{2}=(3\uppi /8 +\uppi /4)/2=5\uppi /16\) and \(\cos (c_{2})=0.556\)<br />


</p>


</li>
<li>


<p>
<span class="listmarker">•</span> \(c_{3}=(\uppi /2 +3\uppi /8)/2=7\uppi /16\) and \(\cos (c_{3})=0.195\)
</p>
</li>
</ul>

<p>
We thus have that
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{12}\)</span>


<!--



                                                                                                              Am = ∆x (f (c0 ) + f (c1 ) + f (c2 ) + f (c3 ))
                                                                                                                      π
                                                                                                                  =       (0.98 + 0.83 + 0.556 + 0.195)
                                                                                                                      8
                                                                                                                  = 1.0057.



-->


<p>


\begin{align*}
A_{m}&amp;=\Delta x\left (f(c_{0})+f(c_{1})+f(c_{2})+f(c_{3})\right )\\ &amp;=\frac {\uppi }{8}\left (0.98+0.83+0.556+0.195\right )\\ &amp;=1.0057.
\end{align*}


</p>

<p>
Simpson’s rule then gives that
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{12}\)</span>

<!--


                                                                                                                             2Am + AT
                                                                                                                    AS =              = 0.997 ≃ 1
                                                                                                                                3

-->

<p>


\begin{equation*}
A_{S}=\frac {2A_{m}+A_{T}}{3}=0.997\simeq 1
\end{equation*}


</p>

<p>
where we have rounded to two decimal places.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-289"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.26</span></span>. </span> Go through the case from the example above,
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{12}\)</span>

<!--

                                                                                                                       Z π
                                                                                                                            2
                                                                                                                  I=            cos(x)dx,
                                                                                                                        0

-->

<p>


\begin{equation*}
I=\int _{0}^{\frac {\uppi }{2}}\cos (x)\ud x,
\end{equation*}


</p>

<p>
and get the answer to 9 decimal places.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-290"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.27</span></span>. </span> Use Simpson’s rule with \(n=6\) sub intervals to calculate
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{12}\)</span>

<!--

                                                                                                                  Z 2p
                                                                                                             I=         1 + sin(x) + cos(x)dx,
                                                                                                                   0

-->

<p>


\begin{equation*}
I=\int _{0}^{2}\sqrt {1+\sin (x)+\cos (x)}\ud x,
\end{equation*}


</p>

<p>
Give your answer to 6 decimal places.
</p>

</li>

</ul>

</div>
<!--
...... section Numerical differentiation ......
-->
<h4 id="autosec-291"><span class="sectionnumber">6.4&#x2003;</span>Numerical differentiation</h4>
<a id="mat1001-autopage-291"></a>


<p>
We now turn to numerical approaches to differentiation. We have seen hints of this in the background when discussing other topics, including as far back as when we discussed differentiation from first principles.<br />

</p>

<p>
A major reason that we need a numerical approach to differentiation is that the definition of differentiation from first principles is very hard to implement on a computer. It is much easier for a computer to understand an approximate method.<br />

</p>
<!--
...... subsection Forward difference method ......
-->
<h5 id="autosec-292">Forward difference method</h5>
<a id="mat1001-autopage-292"></a>


<p>
The key idea is to look at the definition of differentiation from first principles in eq.&nbsp;<span class="textup">(<a href="Differentiation.html#eq:   derivative definition">3.1</a>)</span>, and drop the limit part. e.g. we calculate an approximate gradient for
points a small difference apart. In other words,
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{12}\)</span>

<!--

                                                                   df   f (x + h) − f (x)   ∆f
                                                                      ≃                   =    ,                                                                    (6.13)                                        --><a id="eq:   forward difference approx"></a><!--
                                                                   dx           h            h
-->

<p>

\begin{equation}
\frac {\ud f}{\ud x}\simeq \frac {f(x+h)-f(x)}{h}=\frac {\Delta f}{h}, \label {eq:           forward difference approx}
\end{equation}

</p>

<p>
for \(h\) a small step between neighbouring points. This is known as the <b>forward difference method</b>, since we are looking at the difference between the function at the point \(x\) and at the point \(x+h\) one step ahead of \(x\). This is shown schematically in
fig.&nbsp;<a href="Numerical-Methods.html#fig: forward difference approximation">6.7</a>.<br />

</p>

<figure id="autoid-50" class="figure ">
<div class="center">

<p>
<span
    id="lateximage-mat1001-25"
    class="lateximagesource"
><!--
          y




f (x + h)


  ∆f


  f (x)


                            x
              x   h   x+h
--><img
    src="mat1001-images\image-25.svg"
    alt="( schematic of the forward difference approximation.)"
    style=""
    class="lateximage"
></span>
</p>


<div class="figurecaption">
Figure&nbsp;6.7: A schematic of the forward difference method showing how to approximate the tangent line to the curve at \(x\)

</div>

<a id="fig:    forward difference approximation"></a>

</div>

</figure>

<p>
Note that when we are numerically differentiation we will find the value of the derivative of the function at a specific point.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-296"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.28</span></span>. </span> Consider the function \(f(x)=x^{2}\cos (x)\), we can calculate the approximate derivative at \(x=2\) using eq.&nbsp;<span
class="textup">(<a href="Numerical-Methods.html#eq:          forward difference approx">6.13</a>)</span> and taking the step size to be \(h=0.1, 0.05, 0.025, 0.0125\). We do this as follows:
</p>
<ul class="itemize" style="list-style-type:none">


<li>
<p>
<span class="listmarker">•</span> \(h=0.1\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{13}\)</span>
<!--

                                                                                                      df       f (2 + 0.1) − f (2)   −2.22637 + 1.66459
                                                                                                         (2) ≃                     =                    = −5.61784,
                                                                                                      dx               0.1                  0.1
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2+0.1)-f(2)}{0.1}=\frac {-2.22637+1.66459}{0.1}=-5.61784,
\end{equation*}


</p>
</li>
<li>


<p>
<span class="listmarker">•</span> \(h=0.05\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{13}\)</span>
<!--

                                                                                                      df       f (2 + 0.05) − f (2)   −1.93766 + 1.66459
                                                                                                         (2) ≃                      =                    = −5.46141,
                                                                                                      dx               0.05                  0.05
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2+0.05)-f(2)}{0.05}=\frac {-1.93766+1.66459}{0.05}=-5.46141,
\end{equation*}


</p>
</li>
<li>


<p>
<span class="listmarker">•</span> \(h=0.025\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{13}\)</span>
<!--

                                                                                                     df       f (2 + 0.025) − f (2)   −1.79914 + 1.66459
                                                                                                        (2) ≃                       =                    = −5.38196,
                                                                                                     dx               0.025                 0.025
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2+0.025)-f(2)}{0.025}=\frac {-1.79914+1.66459}{0.025}=-5.38196,
\end{equation*}


</p>
<p>
\(h=0.0125\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{13}\)</span>
<!--

                                                                                                     df       f (2 + 0.0125) − f (2)   −1.73136 + 1.66459
                                                                                                        (2) ≃                        =                    = −5.34196,
                                                                                                     dx               0.0125                 0.0125
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2+0.0125)-f(2)}{0.0125}=\frac {-1.73136+1.66459}{0.0125}=-5.34196,
\end{equation*}


</p>
<p>


</p>
</li>
</ul>

<p>
The true value found by calculating the derivative is
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{13}\)</span>


<!--



                                                                                                                      df
                                                                                                                         (x) = 2x cos(x) − x2 sin(x),
                                                                                                                      dx
                                                                                                                      df
                                                                                                                         (2) = −5.30178,
                                                                                                                      dx


-->


<p>


\begin{align*}
\frac {\ud f}{\ud x}(x)&amp;=2x\cos (x)-x^{2}\sin (x),\\ \frac {\ud f}{\ud x}(2)&amp;=-5.30178,
\end{align*}
so the approximating is getting closer to this as we take a smaller step size.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-297"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.29</span></span>. </span> Use the forward difference method with \(h=0.05\) to approximate the derivative of \(f(x)=4e^{2x}\) at \(x=1\).
</p>

</li>

</ul>

</div>

<p>
The forward difference method is not the only approach to approximating the gradient of the tangent line at a point. There are two other popular approaches, the <b>central difference method</b> and the <b>backwards difference method</b>.
</p>
<!--
...... subsection Backwards difference method ......
-->
<h5 id="autosec-298">Backwards difference method</h5>
<a id="mat1001-autopage-298"></a>


<p>
The backwards difference method is the <i>reverse</i> of the forward difference method. The picture to have in mind, shown in fig.&nbsp;<a href="Numerical-Methods.html#fig: backwards difference approximation">6.8</a>, is essentially the same as in
fig.&nbsp;<a href="Numerical-Methods.html#fig: forward difference approximation">6.7</a>. The difference is that now we are comparing the value of the function at point with its value at the point one step earlier. As an equation this is
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{13}\)</span>

<!--

                                                                         df   f (x) − f (x − h)
                                                                            ≃                   .                                                                       (6.14)                            --><a id="eq:   backwardsdifference approx"></a><!--
                                                                         dx           h
-->

<p>

\begin{equation}
\frac {\ud f}{\ud x}\simeq \frac {f(x)-f(x-h)}{h}.      \label {eq:   backwardsdifference approx}
\end{equation}

</p>

<figure id="autoid-51" class="figure ">
<div class="center">

<p>
<span
    id="lateximage-mat1001-26"
    class="lateximagesource"
><!--
            y




  f (x)


  ∆f


f (x − h)


                              x
                x−h   h   x
--><img
    src="mat1001-images\image-26.svg"
    alt="(Schematic of the backwards difference approximation.)"
    style=""
    class="lateximage"
></span>
</p>


<div class="figurecaption">
Figure&nbsp;6.8: A schematic of the backwards difference method showing how to approximate the tangent line to the curve at \(x\)

</div>

<a id="fig:   backwards difference approximation"></a>

</div>

</figure>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-302"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.30</span></span>. </span> Similar to in the previous case, consider the function \(f(x)=x^{2}\cos (x)\), we can calculate the approximate derivative at
\(x=2\) using the backwards difference method and taking the step size to be \(h=0.1, 0.05, 0.025, 0.0125\). We do this as follows:
</p>
<ul class="itemize" style="list-style-type:none">


<li>
<p>
<span class="listmarker">•</span> \(h=0.1\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{14}\)</span>
<!--

                                                                                                        df       f (2) − f (2 − 0.1)   −1.66459 + 1.16708
                                                                                                           (2) ≃                     =                    = −4.97512,
                                                                                                        dx               0.1                  0.1
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2)-f(2-0.1)}{0.1}=\frac {-1.66459+1.16708}{0.1}=-4.97512,
\end{equation*}


</p>
</li>
<li>


<p>
<span class="listmarker">•</span> \(h=0.05\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{14}\)</span>
<!--

                                                                                                       df       f (2) − f (2 − 0.05)   −1.66459 + 1.40761
                                                                                                          (2) ≃                      =                    = −5.13949,
                                                                                                       dx               0.05                  0.05
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2)-f(2-0.05)}{0.05}=\frac {-1.66459+1.40761}{0.05}=-5.13949,
\end{equation*}


</p>
</li>
<li>


<p>
<span class="listmarker">•</span> \(h=0.025\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{14}\)</span>
<!--

                                                                                                       df       f (2) − f (2 − 0.025)   −1.66459 + 1.53406
                                                                                                          (2) ≃                       =                    = −5.22093,
                                                                                                       dx               0.025                 0.025
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2)-f(2-0.025)}{0.025}=\frac {-1.66459+1.53406}{0.025}=-5.22093,
\end{equation*}


</p>
<p>
\(h=0.0125\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{14}\)</span>
<!--

                                                                                                      df       f (2) − f (2 − 0.0125)   −1.66459 + 1.59882
                                                                                                         (2) ≃                        =                    = −5.26143,
                                                                                                      dx               0.0125                 0.0125
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2)-f(2-0.0125)}{0.0125}=\frac {-1.66459+1.59882}{0.0125}=-5.26143,
\end{equation*}


</p>
<p>


</p>
</li>
</ul>

<p>
The true value we found before is
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{14}\)</span>


<!--



                                                                                                                              df
                                                                                                                                 (2) = −5.30178,
                                                                                                                              dx


-->


<p>


\begin{align*}
\frac {\ud f}{\ud x}(2)&amp;=-5.30178,
\end{align*}
so again the approximating is getting closer to this as we take a smaller step size, though this time we are underestimating the gradient and approaching it from below.
</p>

</li>

</ul>

</div>
<!--
...... subsection Central difference method ......
-->
<h5 id="autosec-303">Central difference method</h5>
<a id="mat1001-autopage-303"></a>


<p>
The central difference method is essentially a combination of the other two methods. In this case we approximate the gradient of the tangent line by using the straight line between the two points \(f(x-h)\) and \(f(x+h)\). In this case we are approximating the derivative
by the gradient,
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{14}\)</span>

<!--

                                                                  df   ∆f   f (x + h) − f (x − h)   f (x + h) − f (x − h)
                                                                     ≃    =                       =                       .                                                                  (6.15)                   --><a id="eq:    central difference method"></a><!--
                                                                  dx   ∆x     (x + h) − (x + h)               h

-->

<p>

\begin{equation}
\frac {\ud f}{\ud x}\simeq \frac {\Delta f}{\Delta x}=\frac {f(x+h)-f(x-h)}{(x+h)-(x+h)}=\frac {f(x+h)-f(x-h)}{h}.                  \label {eq:   central difference method}
\end{equation}

</p>

<p>
The central difference method is often preferred to the forward and backwards difference method, since it is a <i>higher order method</i>. This means that when we discuss the error we will see that it is quadratic in the small parameter \(h\) while the other methods are
linear in \(h\).
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-304"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.31</span></span>. </span> Consider \(f(x)=\tan (x)\) and use the central difference method with \(h=0.1, 0.05, 0.025, 0.0125\) to approximate the
derivative at \(x=1\). This gives:
</p>
<ul class="itemize" style="list-style-type:none">


<li>
<p>
<span class="listmarker">•</span> \(h=0.1\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{15}\)</span>
<!--

                                                                                                        df       f (2 + 0.1) − f (2 − 0.1)
                                                                                                           (2) ≃                           = 6.08625,
                                                                                                        dx                  0.2
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2+0.1)-f(2-0.1)}{0.2}=6.08625,
\end{equation*}


</p>
</li>
<li>


<p>
<span class="listmarker">•</span> \(h=0.05\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{15}\)</span>
<!--

                                                                                                       df       f (2 + 0.05) − f (2 − 0.05)
                                                                                                          (2) ≃                             = 5.84915,
                                                                                                       dx                   0.1
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2+0.05)-f(2-0.05)}{0.1}=5.84915,
\end{equation*}


</p>
</li>
<li>


<p>
<span class="listmarker">•</span> \(h=0.025\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{15}\)</span>
<!--

                                                                                                      df       f (2 + 0.025) − f (2 − 0.025)
                                                                                                         (2) ≃                               = 5.7929,
                                                                                                      dx                   0.05
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2+0.025)-f(2-0.025)}{0.05}=5.7929,
\end{equation*}


</p>
<p>
\(h=0.0125\)
</p>
<span class="hidden"> \(\seteqnumber{0}{6.}{15}\)</span>
<!--

                                                                                                     df       f (2 + 0.0125) − f (2 − 0.0125)
                                                                                                        (2) ≃                                 = 5.77901,
                                                                                                     dx                    0.025
-->
<p>


\begin{equation*}
\frac {\ud f}{\ud x}(2)\simeq \frac {f(2+0.0125)-f(2-0.0125)}{0.025}=5.77901,
\end{equation*}


</p>
<p>


</p>
</li>
</ul>

<p>
The true value of the derivative is \(5.7744\) which our approximations are closing in on.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-305"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.32</span></span>. </span> Use both the forward and central difference methods to approximate the derivative of \(f(x)=\cos (x)\) at \(x=\uppi /4\)
using the step sizes \(h=0.1\) and \(h=0.05\). Compare these to each other and to the exact answer.
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-306"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.33</span></span>. </span> Pick your favourite programming language and write a function which implements the central difference method. Check it
against the example that we computed above, then check a the cases that we explored using the forward and backwards difference method.
</p>

</li>

</ul>

</div>
<!--
...... subsection Understanding the error ......
-->
<h5 id="autosec-307">Understanding the error</h5>
<a id="mat1001-autopage-307"></a>


<p>
We briefly mentioned above that the absolute error is the difference between the true value, \(x\), and the value that our approximation returns, \(X\), is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{15}\)</span>

<!--


                                                                                                                           Absolute error = |X − x|.                                                                                                                 (6.16)

-->

<p>

\begin{equation}
\text {Absolute error}=\vert X-x\vert .
\end{equation}

</p>

<p>
The \(\vert \vert \) mean that this is the absolute value, and of the number within and is always positive. In other words we care about how far away our approximate value is from the true value, but not whether it is greater than or less than the true answer.<br />

</p>

<p>
The absolute relative error is then
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{16}\)</span>

<!--

                                                                                                                                                  X −x
                                                                                                                      Absolute relative error =        ,                                                                                                             (6.17)
                                                                                                                                                    x

-->

<p>

\begin{equation}
\text {Absolute relative error}=\left |\frac {X-x}{x}\right |,
\end{equation}

</p>

<p>
and the percentage error is
</p>

<span class="hidden"> \(\seteqnumber{0}{6.}{17}\)</span>

<!--

                                                                                                                                           X −x
                                                                                                                      Percentage error =        × 100%                                                                                                               (6.18)
                                                                                                                                             x

-->

<p>

\begin{equation}
\text {Percentage error}=\left |\frac {X-x}{x}\right |\times 100\%
\end{equation}

</p>

<p>
There is a discussion of error and the related concept of convergence of an approximation, i.e. whether the approximation is closing in on the true value and how quickly, in Lissamen and West [2004].
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-308"></a>
<span class="amsthmnameplain">Example</span><span class="amsthmnumberplain"> <span class="textup">6.34</span></span>. </span> Consider the examples of approximating the derivative of \(x^{2}\cos (x)\) using both the backwards and forwards difference
method with \(h=0.0125\). The relative and absolute errors are shown in table&nbsp;<a href="Numerical-Methods.html#table:   percentage error 1">6.14</a>.
</p>

<figure id="autoid-52" class="table ">
<div class="center">


<div class="figurecaption">
Table&nbsp;6.14: A comparison of our approximations to the derivative of \(x^{2}\cos (x)\) at \(x=2\) and the percentage error in each case.

</div>

<a id="table:   percentage error 1"></a>
<table>

<tr style="display:none"><th>.</th></tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:     1px solid black"></td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">Approximate derivative</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">Relative absolute error</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">Percentage error</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:     1px solid black">Forward difference</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(-5.34196\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0.00758 \)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0.758\% \)</td>
</tr>


<tr class="hline">
<td class="tdc tvertbarl tvertbarr" style="border-left:   1px solid black; border-right:     1px solid black">Backward difference</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(-5.26143\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0.00761\)</td>
<td class="tdc tvertbarr" style="border-right:   1px solid black">\(0.761\%\)</td>
</tr>


<tr class="hline" aria-hidden="true">
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
<td class="tdc"></td>
</tr>
</table>

</div>

</figure>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><a id="mat1001-autopage-311"></a>
<span class="amsthmnameplain">Exercise</span><span class="amsthmnumberplain"> <span class="textup">6.35</span></span>. </span> Go back to all of the examples of using the forward, backwards, and central difference equation and calculate the relative and
percentage error in each case.
</p>

</li>

</ul>

</div>
<!--
...... section Numerical approaches to differential equations ......
-->
<h4 id="autosec-312"><span class="sectionnumber">6.5&#x2003;</span>Numerical approaches to differential equations</h4>
<a id="mat1001-autopage-312"></a>


<p>
This is a non-examinable section and is not taught every year. It is included in the indicative content of the module but is not assessed in the learning outcomes. Content will be added here at the same time as content is added to chapter&nbsp;<a
href="Differential-Equations.html#sec:diff eqs">5</a> since that is the theoretical background for what will be discussed numerically here.
</p>

</section>

</main>

</div>

<footer>

<p>
Contact <a href="mailto:rossc@edgehill.ac.uk" target="_blank" >rossc[at]edgehill[dot]ac[dot]uk</a> and Copyright CC BY 4.0
</p>

</footer>


<nav class="botnavigation"><a href="index.html" class="linkhome" >
Home</a></nav>

</body>
</html>
